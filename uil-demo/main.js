(()=>{var r={frag:document.createDocumentFragment(),colorRing:null,joystick_0:null,joystick_1:null,circular:null,knob:null,svgns:"http://www.w3.org/2000/svg",links:"http://www.w3.org/1999/xlink",htmls:"http://www.w3.org/1999/xhtml",DOM_SIZE:["height","width","top","left","bottom","right","margin-left","margin-right","margin-top","margin-bottom"],SVG_TYPE_D:["pattern","defs","transform","stop","animate","radialGradient","linearGradient","animateMotion","use","filter","feColorMatrix"],SVG_TYPE_G:["svg","rect","circle","path","polygon","text","g","line","foreignObject"],PI:Math.PI,TwoPI:Math.PI*2,pi90:Math.PI*.5,pi60:Math.PI/3,torad:Math.PI/180,todeg:180/Math.PI,clamp:function(h,t,s){return h=h<t?t:h,h=h>s?s:h,h},size:{w:240,h:20,p:30,s:8},colors:{text:"#dcdcdc",textOver:"#FFFFFF",txtselectbg:"none",background:"rgba(50,50,50,0.5)",backgroundOver:"rgba(50,50,50,0.5)",inputBorder:"#454545",inputHolder:"#808080",inputBorderSelect:"#005AAA",inputBg:"rgba(0,0,0,0.1)",inputOver:"rgba(0,0,0,0.2)",border:"#454545",borderOver:"#5050AA",borderSelect:"#308AFF",button:"#3c3c3c",boolbg:"#181818",boolon:"#C0C0C0",select:"#308AFF",moving:"#03afff",down:"#024699",over:"#024699",action:"#FF3300",stroke:"rgba(11,11,11,0.5)",scroll:"#333333",scrollback:"rgba(44,44,44,0.2)",scrollbackover:"rgba(44,44,44,0.2)",hide:"rgba(0,0,0,0)",groupBorder:"#3e3e3e",buttonBorder:"#4a4a4a",fontFamily:"Tahoma",fontShadow:"none",fontSize:11,radius:4},css:{basic:"position:absolute; pointer-events:none; box-sizing:border-box; margin:0; padding:0; overflow:hidden; -o-user-select:none; -ms-user-select:none; -khtml-user-select:none; -webkit-user-select:none; -moz-user-select:none;",button:"display:flex; justify-content:center; align-items:center; text-align:center;"},svgs:{group:"M 7 7 L 7 8 8 8 8 7 7 7 M 5 7 L 5 8 6 8 6 7 5 7 M 3 7 L 3 8 4 8 4 7 3 7 M 7 5 L 7 6 8 6 8 5 7 5 M 6 6 L 6 5 5 5 5 6 6 6 M 7 3 L 7 4 8 4 8 3 7 3 M 6 4 L 6 3 5 3 5 4 6 4 M 3 5 L 3 6 4 6 4 5 3 5 M 3 3 L 3 4 4 4 4 3 3 3 Z",arrow:"M 3 8 L 8 5 3 2 3 8 Z",arrowDown:"M 5 8 L 8 3 2 3 5 8 Z",arrowUp:"M 5 2 L 2 7 8 7 5 2 Z",solid:"M 13 10 L 13 1 4 1 1 4 1 13 10 13 13 10 M 11 3 L 11 9 9 11 3 11 3 5 5 3 11 3 Z",body:"M 13 10 L 13 1 4 1 1 4 1 13 10 13 13 10 M 11 3 L 11 9 9 11 3 11 3 5 5 3 11 3 M 5 4 L 4 5 4 10 9 10 10 9 10 4 5 4 Z",vehicle:"M 13 6 L 11 1 3 1 1 6 1 13 3 13 3 11 11 11 11 13 13 13 13 6 M 2.4 6 L 4 2 10 2 11.6 6 2.4 6 M 12 8 L 12 10 10 10 10 8 12 8 M 4 8 L 4 10 2 10 2 8 4 8 Z",articulation:"M 13 9 L 12 9 9 2 9 1 5 1 5 2 2 9 1 9 1 13 5 13 5 9 4 9 6 5 8 5 10 9 9 9 9 13 13 13 13 9 Z",character:"M 13 4 L 12 3 9 4 5 4 2 3 1 4 5 6 5 8 4 13 6 13 7 9 8 13 10 13 9 8 9 6 13 4 M 6 1 L 6 3 8 3 8 1 6 1 Z",terrain:"M 13 8 L 12 7 Q 9.06 -3.67 5.95 4.85 4.04 3.27 2 7 L 1 8 7 13 13 8 M 3 8 Q 3.78 5.420 5.4 6.6 5.20 7.25 5 8 L 7 8 Q 8.39 -0.16 11 8 L 7 11 3 8 Z",joint:"M 7.7 7.7 Q 8 7.45 8 7 8 6.6 7.7 6.3 7.45 6 7 6 6.6 6 6.3 6.3 6 6.6 6 7 6 7.45 6.3 7.7 6.6 8 7 8 7.45 8 7.7 7.7 M 3.35 8.65 L 1 11 3 13 5.35 10.65 Q 6.1 11 7 11 8.28 11 9.25 10.25 L 7.8 8.8 Q 7.45 9 7 9 6.15 9 5.55 8.4 5 7.85 5 7 5 6.54 5.15 6.15 L 3.7 4.7 Q 3 5.712 3 7 3 7.9 3.35 8.65 M 10.25 9.25 Q 11 8.28 11 7 11 6.1 10.65 5.35 L 13 3 11 1 8.65 3.35 Q 7.9 3 7 3 5.7 3 4.7 3.7 L 6.15 5.15 Q 6.54 5 7 5 7.85 5 8.4 5.55 9 6.15 9 7 9 7.45 8.8 7.8 L 10.25 9.25 Z",ray:"M 9 11 L 5 11 5 12 9 12 9 11 M 12 5 L 11 5 11 9 12 9 12 5 M 11.5 10 Q 10.9 10 10.45 10.45 10 10.9 10 11.5 10 12.2 10.45 12.55 10.9 13 11.5 13 12.2 13 12.55 12.55 13 12.2 13 11.5 13 10.9 12.55 10.45 12.2 10 11.5 10 M 9 10 L 10 9 2 1 1 2 9 10 Z",collision:"M 11 12 L 13 10 10 7 13 4 11 2 7.5 5.5 9 7 7.5 8.5 11 12 M 3 2 L 1 4 4 7 1 10 3 12 8 7 3 2 Z",map:"M 13 1 L 1 1 1 13 13 13 13 1 M 12 2 L 12 7 7 7 7 12 2 12 2 7 7 7 7 2 12 2 Z",material:"M 13 1 L 1 1 1 13 13 13 13 1 M 12 2 L 12 7 7 7 7 12 2 12 2 7 7 7 7 2 12 2 Z",texture:"M 13 4 L 13 1 1 1 1 4 5 4 5 13 9 13 9 4 13 4 Z",object:"M 10 1 L 7 4 4 1 1 1 1 13 4 13 4 5 7 8 10 5 10 13 13 13 13 1 10 1 Z",none:"M 9 5 L 5 5 5 9 9 9 9 5 Z",cursor:"M 4 7 L 1 10 1 12 2 13 4 13 7 10 9 14 14 0 0 5 4 7 Z"},setStyle:function(h){for(var t in h)r.colors[t]&&(r.colors[t]=h[t]);r.setText()},setText:function(h,t,s,i){let e=r.colors;s!==void 0&&(e.fontFamily=s),t!==void 0&&(e.text=t),h!==void 0&&(e.fontSize=h),r.css.txt=r.css.basic+"font-family:"+e.fontFamily+"; font-size:"+e.fontSize+"px; color:"+e.text+"; padding:2px 10px; left:0; top:2px; height:16px; width:100px; overflow:hidden; white-space: nowrap;",i!==void 0&&(r.css.txt+=" text-shadow:"+i+"; "),e.fontShadow!=="none"&&(r.css.txt+=" text-shadow: 1px 1px 1px "+e.fontShadow+";"),r.css.txtselect=r.css.txt+"display:flex; justify-content:left; align-items:center; text-align:left;padding:2px 5px; border:1px dashed "+e.border+"; background:"+e.txtselectbg+";",r.css.item=r.css.txt+"position:relative; background:rgba(0,0,0,0.2); margin-bottom:1px;"},cloneColor:function(){return Object.assign({},r.colors)},cloneCss:function(){return Object.assign({},r.css)},clone:function(h){return h.cloneNode(!0)},setSvg:function(h,t,s,i,e){i===-1?h.setAttributeNS(null,t,s):e!==void 0?h.childNodes[i||0].childNodes[e||0].setAttributeNS(null,t,s):h.childNodes[i||0].setAttributeNS(null,t,s)},setCss:function(h,t){for(let s in t)r.DOM_SIZE.indexOf(s)!==-1?h.style[s]=t[s]+"px":h.style[s]=t[s]},set:function(h,t){for(let s in t)s==="txt"&&(h.textContent=t[s]),s==="link"?h.setAttributeNS(r.links,"xlink:href",t[s]):h.setAttributeNS(null,s,t[s])},get:function(h,t){if(t===void 0)return h;if(isNaN(t)){if(t instanceof Array){if(t.length===2)return h.childNodes[t[0]].childNodes[t[1]];if(t.length===3)return h.childNodes[t[0]].childNodes[t[1]].childNodes[t[2]]}}else return h.childNodes[t]},dom:function(h,t,s,i,e){return h=h||"div",r.SVG_TYPE_D.indexOf(h)!==-1||r.SVG_TYPE_G.indexOf(h)!==-1?h==="svg"?(i=document.createElementNS(r.svgns,"svg"),r.set(i,s)):(i===void 0&&(i=document.createElementNS(r.svgns,"svg")),r.addAttributes(i,h,s,e)):i===void 0?i=document.createElementNS(r.htmls,h):i=i.appendChild(document.createElementNS(r.htmls,h)),t&&(i.style.cssText=t),e===void 0?i:i.childNodes[e||0]},addAttributes:function(h,t,s,i){let e=document.createElementNS(r.svgns,t);return r.set(e,s),r.get(h,i).appendChild(e),r.SVG_TYPE_G.indexOf(t)!==-1&&(e.style.pointerEvents="none"),e},clear:function(h){for(r.purge(h);h.firstChild;)h.firstChild.firstChild&&r.clear(h.firstChild),h.removeChild(h.firstChild)},purge:function(h){let t=h.attributes,s,i;if(t)for(s=t.length;s--;)i=t[s].name,typeof h[i]=="function"&&(h[i]=null);if(t=h.childNodes,t)for(s=t.length;s--;)r.purge(h.childNodes[s])},ColorLuma:function(h,t){h==="n"&&(h="#000"),h=String(h).replace(/[^0-9a-f]/gi,""),h.length<6&&(h=h[0]+h[0]+h[1]+h[1]+h[2]+h[2]),t=t||0;let s="#",i,e;for(e=0;e<3;e++)i=parseInt(h.substr(e*2,2),16),i=Math.round(Math.min(Math.max(0,i+i*t),255)).toString(16),s+=("00"+i).substr(i.length);return s},findDeepInver:function(h){return h[0]*.3+h[1]*.59+h[2]*.11<=.6},hexToHtml:function(h){return h=h===void 0?0:h,"#"+("000000"+h.toString(16)).substr(-6)},htmlToHex:function(h){return h.toUpperCase().replace("#","0x")},u255:function(h,t){return parseInt(h.substring(t,t+2),16)/255},u16:function(h,t){return parseInt(h.substring(t,t+1),16)/15},unpack:function(h){if(h.length==7)return[r.u255(h,1),r.u255(h,3),r.u255(h,5)];if(h.length==4)return[r.u16(h,1),r.u16(h,2),r.u16(h,3)]},htmlRgb:function(h){return"rgb("+Math.round(h[0]*255)+","+Math.round(h[1]*255)+","+Math.round(h[2]*255)+")"},pad:function(h){return h.length==1&&(h="0"+h),h},rgbToHex:function(h){let t=Math.round(h[0]*255).toString(16),s=Math.round(h[1]*255).toString(16),i=Math.round(h[2]*255).toString(16);return"#"+r.pad(t)+r.pad(s)+r.pad(i)},hueToRgb:function(h,t,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?h+(t-h)*6*s:s<1/2?t:s<2/3?h+(t-h)*6*(2/3-s):h},rgbToHsl:function(h){let t=h[0],s=h[1],i=h[2],e=Math.min(t,s,i),l=Math.max(t,s,i),o=l-e,u=0,c=0,f=(e+l)/2;return f>0&&f<1&&(c=o/(f<.5?2*f:2-2*f)),o>0&&(l==t&&l!=s&&(u+=(s-i)/o),l==s&&l!=i&&(u+=2+(i-t)/o),l==i&&l!=t&&(u+=4+(t-s)/o),u/=6),[u,c,f]},hslToRgb:function(h){let t,s,i=h[0],e=h[1],l=h[2];return e===0?[l,l,l]:(s=l<=.5?l*(e+1):l+e-l*e,t=l*2-s,[r.hueToRgb(t,s,i+.33333),r.hueToRgb(t,s,i),r.hueToRgb(t,s,i-.33333)])},makeGradiant:function(h,t,s,i){r.dom(h,null,t,s,0);let e=s.childNodes[0].childNodes.length-1,l;for(let o=0;o<i.length;o++)l=i[o],r.dom("stop",null,{offset:l[0]+"%","stop-color":l[1],"stop-opacity":l[2]},s,[0,e])},makeKnob:function(h){let t=128,s=34,i=r.dom("svg",r.css.basic,{viewBox:"0 0 "+t+" "+t,width:t,height:t,preserveAspectRatio:"none"});r.dom("circle","",{cx:64,cy:64,r:s,fill:r.colors.button,stroke:"rgba(0,0,0,0.3)","stroke-width":8},i),r.dom("path","",{d:"",stroke:r.colors.text,"stroke-width":4,fill:"none","stroke-linecap":"round"},i),r.dom("circle","",{cx:64,cy:64,r:s+7,stroke:"rgba(0,0,0,0.1)","stroke-width":7,fill:"none"},i),r.dom("path","",{d:"",stroke:"rgba(255,255,255,0.3)","stroke-width":2,fill:"none","stroke-linecap":"round","stroke-opacity":.5},i),r.knob=i},makeCircular:function(h){let t=128,s=40,i=r.dom("svg",r.css.basic,{viewBox:"0 0 "+t+" "+t,width:t,height:t,preserveAspectRatio:"none"});r.dom("circle","",{cx:64,cy:64,r:s,stroke:"rgba(0,0,0,0.1)","stroke-width":10,fill:"none"},i),r.dom("path","",{d:"",stroke:r.colors.text,"stroke-width":7,fill:"none","stroke-linecap":"butt"},i),r.circular=i},makeJoystick:function(h){let t=128,s,i=Math.floor((t-30)*.5),e=Math.floor(i*.6),l=r.dom("svg",r.css.basic,{viewBox:"0 0 "+t+" "+t,width:t,height:t,preserveAspectRatio:"none"});if(r.dom("defs",null,{},l),r.dom("g",null,{},l),h===0){s=[[40,"rgb(0,0,0)",.3],[80,"rgb(0,0,0)",0],[90,"rgb(50,50,50)",.4],[100,"rgb(50,50,50)",0]],r.makeGradiant("radialGradient",{id:"grad",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"},l,s),s=[[60,"rgb(0,0,0)",.5],[100,"rgb(0,0,0)",0]],r.makeGradiant("radialGradient",{id:"gradS",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"},l,s);let o=["rgb(40,40,40)","rgb(48,48,48)","rgb(30,30,30)"],u=["rgb(1,90,197)","rgb(3,95,207)","rgb(0,65,167)"];s=[[30,o[0],1],[60,o[1],1],[80,o[1],1],[100,o[2],1]],r.makeGradiant("radialGradient",{id:"gradIn",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"},l,s),s=[[30,u[0],1],[60,u[1],1],[80,u[1],1],[100,u[2],1]],r.makeGradiant("radialGradient",{id:"gradIn2",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"},l,s),r.dom("circle","",{cx:64,cy:64,r:i,fill:"url(#grad)"},l),r.dom("circle","",{cx:64+5,cy:64+10,r:e+10,fill:"url(#gradS)"},l),r.dom("circle","",{cx:64,cy:64,r:e,fill:"url(#gradIn)"},l),r.joystick_0=l}else s=[[69,"rgb(0,0,0)",0],[70,"rgb(0,0,0)",.3],[100,"rgb(0,0,0)",0]],r.makeGradiant("radialGradient",{id:"gradX",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"},l,s),r.dom("circle","",{cx:64,cy:64,r:i,fill:"none",stroke:"rgba(100,100,100,0.25)","stroke-width":"4"},l),r.dom("circle","",{cx:64,cy:64,r:e+14,fill:"url(#gradX)"},l),r.dom("circle","",{cx:64,cy:64,r:e,fill:"none",stroke:"rgb(100,100,100)","stroke-width":"4"},l),r.joystick_1=l},makeColorRing:function(){let h=256,t=r.dom("svg",r.css.basic,{viewBox:"0 0 "+h+" "+h,width:h,height:h,preserveAspectRatio:"none"});r.dom("defs",null,{},t),r.dom("g",null,{},t);let s=30,i=(h-s)*.5,e=h*.5,l=24,o=8/i/l*Math.PI,u=0,c,f,x,g,d,b,v,C,w,y=[];for(b=0;b<=l;++b){if(x=b/l,g=x*r.TwoPI,c=(u+g)*.5,f=1/Math.cos((g-u)*.5),d=[Math.sin(u),-Math.cos(u),Math.sin(c)*f,-Math.cos(c)*f,Math.sin(g),-Math.cos(g)],y[1]=r.rgbToHex(r.hslToRgb([x,1,.5])),b>0){for(v=6;v--;)d[v]=(d[v]*i+e).toFixed(2);C=" M"+d[0]+" "+d[1]+" Q"+d[2]+" "+d[3]+" "+d[4]+" "+d[5],w=[[0,y[0],1],[100,y[1],1]],r.makeGradiant("linearGradient",{id:"G"+b,x1:d[0],y1:d[1],x2:d[4],y2:d[5],gradientUnits:"userSpaceOnUse"},t,w),r.dom("path","",{d:C,"stroke-width":s,stroke:"url(#G"+b+")","stroke-linecap":"butt"},t,1)}u=g-o,y[0]=y[1]}let S=84.9;w=[[0,"#FFFFFF",1],[50,"#FFFFFF",0],[50,"#000000",0],[100,"#000000",1]],r.makeGradiant("linearGradient",{id:"GL0",x1:0,y1:e-S,x2:0,y2:e+S,gradientUnits:"userSpaceOnUse"},t,w),w=[[0,"#7f7f7f",1],[50,"#7f7f7f",.5],[100,"#7f7f7f",0]],r.makeGradiant("linearGradient",{id:"GL1",x1:e-49.05,y1:0,x2:e+98,y2:0,gradientUnits:"userSpaceOnUse"},t,w),r.dom("g",null,{"transform-origin":"128px 128px",transform:"rotate(0)"},t),r.dom("polygon","",{points:"78.95 43.1 78.95 212.85 226 128",fill:"red"},t,2),r.dom("polygon","",{points:"78.95 43.1 78.95 212.85 226 128",fill:"url(#GL1)","stroke-width":1,stroke:"url(#GL1)"},t,2),r.dom("polygon","",{points:"78.95 43.1 78.95 212.85 226 128",fill:"url(#GL0)","stroke-width":1,stroke:"url(#GL0)"},t,2),r.dom("path","",{d:"M 255.75 136.5 Q 256 132.3 256 128 256 123.7 255.75 119.5 L 241 128 255.75 136.5 Z",fill:"none","stroke-width":2,stroke:"#000"},t,2),r.dom("circle","",{cx:128,cy:128,r:6,"stroke-width":2,stroke:"#000",fill:"none"},t),r.colorRing=t},icon:function(h,t,s){s=s||40,t=t||"#DEDEDE";let i="0 0 256 256",e=["<svg xmlns='"+r.svgns+"' version='1.1' xmlns:xlink='"+r.htmls+"' style='pointer-events:none;' preserveAspectRatio='xMinYMax meet' x='0px' y='0px' width='"+s+"px' height='"+s+"px' viewBox='"+i+"'><g>"];switch(h){case"logo":e[1]="<path id='logoin' fill='"+t+"' stroke='none' d='"+r.logoFill_d+"'/>";break;case"save":e[1]="<path stroke='"+t+"' stroke-width='4' stroke-linejoin='round' stroke-linecap='round' fill='none' d='M 26.125 17 L 20 22.95 14.05 17 M 20 9.95 L 20 22.95'/><path stroke='"+t,e[1]+="' stroke-width='2.5' stroke-linejoin='round' stroke-linecap='round' fill='none' d='M 32.6 23 L 32.6 25.5 Q 32.6 28.5 29.6 28.5 L 10.6 28.5 Q 7.6 28.5 7.6 25.5 L 7.6 23'/>";break}return e[2]="</g></svg>",e.join(`
`)},logoFill_d:["M 171 150.75 L 171 33.25 155.5 33.25 155.5 150.75 Q 155.5 162.2 147.45 170.2 139.45 178.25 128 178.25 116.6 178.25 108.55 170.2 100.5 162.2 100.5 150.75 ","L 100.5 33.25 85 33.25 85 150.75 Q 85 168.65 97.55 181.15 110.15 193.75 128 193.75 145.9 193.75 158.4 181.15 171 168.65 171 150.75 ","M 200 33.25 L 184 33.25 184 150.8 Q 184 174.1 167.6 190.4 151.3 206.8 128 206.8 104.75 206.8 88.3 190.4 72 174.1 72 150.8 L 72 33.25 56 33.25 56 150.75 ","Q 56 180.55 77.05 201.6 98.2 222.75 128 222.75 157.8 222.75 178.9 201.6 200 180.55 200 150.75 L 200 33.25 Z"].join(`
`)};r.setText();var a=r,n={ui:[],ID:null,lock:!1,wlock:!1,current:-1,needReZone:!0,isEventsInit:!1,prevDefault:["contextmenu","mousedown","mousemove","mouseup"],pointerEvent:["pointerdown","pointermove","pointerup"],xmlserializer:new XMLSerializer,tmpTime:null,tmpImage:null,oldCursor:"auto",input:null,parent:null,firstImput:!0,hiddenImput:null,hiddenSizer:null,hasFocus:!1,startInput:!1,inputRange:[0,0],cursorId:0,str:"",pos:0,startX:-1,moveX:-1,debugInput:!1,isLoop:!1,listens:[],e:{type:null,clientX:0,clientY:0,keyCode:NaN,key:null,delta:0},isMobile:!1,add:function(h){n.ui.push(h),n.getZone(h),n.isEventsInit||n.initEvents()},testMobile:function(){let h=navigator.userAgent;return!!(h.match(/Android/i)||h.match(/webOS/i)||h.match(/iPhone/i)||h.match(/iPad/i)||h.match(/iPod/i)||h.match(/BlackBerry/i)||h.match(/Windows Phone/i))},remove:function(h){let t=n.ui.indexOf(h);t!==-1&&(n.removeListen(h),n.ui.splice(t,1)),n.ui.length===0&&n.removeEvents()},initEvents:function(){if(n.isEventsInit)return;let h=document.body;n.isMobile=n.testMobile(),n.isMobile?(h.addEventListener("touchstart",n,!1),h.addEventListener("touchend",n,!1),h.addEventListener("touchmove",n,!1)):(h.addEventListener("contextmenu",n,!1),h.addEventListener("wheel",n,!1),document.addEventListener("click",n,!1),h.addEventListener("pointerdown",n,!1),document.addEventListener("pointermove",n,!1),document.addEventListener("pointerup",n,!1)),window.addEventListener("keydown",n,!1),window.addEventListener("keyup",n,!1),window.addEventListener("resize",n.resize,!1),n.isEventsInit=!0},removeEvents:function(){if(!n.isEventsInit)return;let h=document.body;n.isMobile?(h.removeEventListener("touchstart",n,!1),h.removeEventListener("touchend",n,!1),h.removeEventListener("touchmove",n,!1)):(h.removeEventListener("contextmenu",n,!1),h.removeEventListener("wheel",n,!1),document.removeEventListener("click",n,!1),h.removeEventListener("pointerdown",n,!1),document.removeEventListener("pointermove",n,!1),document.removeEventListener("pointerup",n,!1)),window.removeEventListener("keydown",n),window.removeEventListener("keyup",n),window.removeEventListener("resize",n.resize),n.isEventsInit=!1},resize:function(){n.needReZone=!0;let h=n.ui.length,t;for(;h--;)t=n.ui[h],t.isGui&&!t.isCanvasOnly&&t.autoResize&&t.setHeight()},out:function(){console.log("im am out"),n.clearOldID()},in:function(){console.log("im am in")},handleEvent:function(h){if(h.type.indexOf(n.prevDefault)!==-1&&h.preventDefault(),h.type.indexOf(n.pointerEvent)!==-1&&(h.pointerType!=="mouse"||h.pointerType!=="pen")||h.type==="contextmenu")return;n.findZone();let t=n.e;h.type==="keydown"&&n.keydown(h),h.type==="keyup"&&n.keyup(h),h.type==="wheel"?t.delta=h.deltaY>0?1:-1:t.delta=0,t.clientX=h.clientX||0,t.clientY=h.clientY||0,t.type=h.type,n.isMobile&&(h.touches&&h.touches.length>0&&(t.clientX=h.touches[0].clientX||0,t.clientY=h.touches[0].clientY||0),h.type==="touchstart"&&(t.type="mousedown"),h.type==="touchend"&&(t.type="mouseup"),h.type==="touchmove"&&(t.type="mousemove")),h.type==="pointerdown"&&(t.type="mousedown"),h.type==="pointerup"&&(t.type="mouseup"),h.type==="pointermove"&&(t.type="mousemove"),t.type==="mousedown"&&(n.lock=!0),t.type==="mouseup"&&(n.lock=!1),n.isMobile&&t.type==="mousedown"&&n.findID(t),t.type==="mousemove"&&!n.lock&&n.findID(t),n.ID!==null&&(n.ID.isCanvasOnly&&(t.clientX=n.ID.mouse.x,t.clientY=n.ID.mouse.y),n.ID.handleEvent(t)),n.isMobile&&t.type==="mouseup"&&n.clearOldID()},findID:function(h){let t=n.ui.length,s=-1,i,e,l;for(;t--;)if(i=n.ui[t],i.isCanvasOnly?(e=i.mouse.x,l=i.mouse.y):(e=h.clientX,l=h.clientY),n.onZone(i,e,l)){s=t,s!==n.current&&(n.clearOldID(),n.current=s,n.ID=i);break}s===-1&&n.clearOldID()},clearOldID:function(){!n.ID||(n.current=-1,n.ID.reset(),n.ID=null,n.cursor())},calcUis:function(h,t,s){let i=h.length,e,l,o=0,u=0;for(l=0;l<i;l++)e=h[l],e.zone.w=e.w,e.zone.h=e.h,e.autoWidth?(e.zone.x=t.x,e.zone.y=s,s+=e.h+1):(o===0&&(s+=e.h+1),e.zone.x=t.x+o,e.zone.y=o===0?s-e.h:u,u=e.zone.y,o+=e.w,o+e.w>t.w&&(o=0)),e.isGroup&&e.calcUis()},findTarget:function(h,t){let s=h.length;for(;s--;)if(n.onZone(h[s],t.clientX,t.clientY))return s;return-1},findZone:function(h){if(!(!n.needReZone&&!h)){for(var t=n.ui.length,s;t--;)s=n.ui[t],n.getZone(s),s.isGui&&s.calcUis();n.needReZone=!1}},onZone:function(h,t,s){if(t===void 0||s===void 0)return!1;let i=h.zone,e=t-i.x,l=s-i.y,o=e>=0&&l>=0&&e<=i.w&&l<=i.h;return o?h.local.set(e,l):h.local.neg(),o},getZone:function(h){if(h.isCanvasOnly)return;let t=h.getDom().getBoundingClientRect();h.zone={x:t.left,y:t.top,w:t.width,h:t.height}},cursor:function(h){h=h||"auto",h!==n.oldCursor&&(document.body.style.cursor=h,n.oldCursor=h)},toCanvas:function(h,t,s,i){if(i&&n.tmpTime!==null&&(clearTimeout(n.tmpTime),n.tmpTime=null),n.tmpTime!==null)return;n.lock&&(n.tmpTime=setTimeout(function(){n.tmpTime=null},10));let e=!1;(t!==h.canvas.width||s!==h.canvas.height)&&(e=!0),n.tmpImage===null&&(n.tmpImage=new Image);let l=n.tmpImage,o=n.xmlserializer.serializeToString(h.content),u='<svg xmlns="http://www.w3.org/2000/svg" width="'+t+'" height="'+s+'"><foreignObject style="pointer-events: none; left:0;" width="100%" height="100%">'+o+"</foreignObject></svg>";l.onload=function(){let c=h.canvas.getContext("2d");e?(h.canvas.width=t,h.canvas.height=s):c.clearRect(0,0,t,s),c.drawImage(this,0,0),h.onDraw()},l.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(u),l.crossOrigin=""},setHidden:function(){if(n.hiddenImput===null){let h=n.debugInput?"":"opacity:0; zIndex:0;",t=n.parent.css.txt+"padding:0; width:auto; height:auto; text-shadow:none;";t+="left:10px; top:auto; border:none; color:#FFF; background:#000;"+h,n.hiddenImput=document.createElement("input"),n.hiddenImput.type="text",n.hiddenImput.style.cssText=t+"bottom:30px;"+(n.debugInput?"":"transform:scale(0);"),n.hiddenSizer=document.createElement("div"),n.hiddenSizer.style.cssText=t+"bottom:60px;",document.body.appendChild(n.hiddenImput),document.body.appendChild(n.hiddenSizer)}n.hiddenImput.style.width=n.input.clientWidth+"px",n.hiddenImput.value=n.str,n.hiddenSizer.innerHTML=n.str,n.hasFocus=!0},clearHidden:function(h){n.hiddenImput!==null&&(n.hasFocus=!1)},clickPos:function(h){let t=n.str.length,s=0,i=0;for(;t--&&(s+=n.textWidth(n.str[i]),!(s>=h));)i++;return i},upInput:function(h,t){if(n.parent===null)return!1;let s=!1;if(t){let i=n.clickPos(h);n.moveX=i,n.startX===-1?(n.startX=i,n.cursorId=i,n.inputRange=[n.startX,n.startX]):n.moveX!==n.startX&&(n.startX>n.moveX?n.inputRange=[n.moveX,n.startX]:n.inputRange=[n.startX,n.moveX]),s=!0}else n.startX!==-1&&(n.hasFocus=!0,n.hiddenImput.focus(),n.hiddenImput.selectionStart=n.inputRange[0],n.hiddenImput.selectionEnd=n.inputRange[1],n.startX=-1,s=!0);return s&&n.selectParent(),s},selectParent:function(){var h=n.textWidth(n.str.substring(0,n.cursorId)),t=n.textWidth(n.str.substring(0,n.inputRange[0])),s=n.textWidth(n.str.substring(n.inputRange[0],n.inputRange[1]));n.parent.select(h,t,s)},textWidth:function(h){return n.hiddenSizer===null?0:(h=h.replace(/ /g,"&nbsp;"),n.hiddenSizer.innerHTML=h,n.hiddenSizer.clientWidth)},clearInput:function(){n.parent!==null&&(n.firstImput||n.parent.validate(!0),n.clearHidden(),n.parent.unselect(),n.input.style.background=n.parent.colors.inputBg,n.input.style.borderColor=n.parent.colors.inputBorder,n.parent.isEdit=!1,n.input=null,n.parent=null,n.str="",n.firstImput=!0)},setInput:function(h,t){n.clearInput(),n.input=h,n.parent=t,n.input.style.background=n.parent.colors.inputOver,n.input.style.borderColor=n.parent.colors.inputBorderSelect,n.str=n.input.textContent,n.setHidden()},keydown:function(h){if(n.parent===null)return;let t=h.which;h.shiftKey,n.firstImput=!1,n.hasFocus&&(window.focus(),n.hiddenImput.focus()),n.parent.isEdit=!0,t===13?n.clearInput():n.input.isNum?h.keyCode>47&&h.keyCode<58||h.keyCode>95&&h.keyCode<106||h.keyCode===190||h.keyCode===110||h.keyCode===8||h.keyCode===109?n.hiddenImput.readOnly=!1:n.hiddenImput.readOnly=!0:n.hiddenImput.readOnly=!1},keyup:function(h){n.parent!==null&&(n.str=n.hiddenImput.value,n.parent.allEqual?n.parent.sameStr(n.str):n.input.textContent=n.str,n.cursorId=n.hiddenImput.selectionStart,n.inputRange=[n.hiddenImput.selectionStart,n.hiddenImput.selectionEnd],n.selectParent(),n.parent.validate())},loop:function(){n.isLoop&&requestAnimationFrame(n.loop),n.update()},update:function(){let h=n.listens.length;for(;h--;)n.listens[h].listening()},removeListen:function(h){let t=n.listens.indexOf(h);t!==-1&&n.listens.splice(t,1),n.listens.length===0&&(n.isLoop=!1)},addListen:function(h){return n.listens.indexOf(h)!==-1?!1:(n.listens.push(h),n.isLoop||(n.isLoop=!0,n.loop()),!0)}},p=n,k=class{constructor(t=0,s=0){this.x=t,this.y=s}set(t,s){return this.x=t,this.y=s,this}divide(t){return this.x/=t.x,this.y/=t.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divideScalar(t){return this.multiplyScalar(1/t)}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}angle(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t}addScalar(t){return this.x+=t,this.y+=t,this}negate(){return this.x*=-1,this.y*=-1,this}neg(){return this.x=-1,this.y=-1,this}isZero(){return this.x===0&&this.y===0}copy(t){return this.x=t.x,this.y=t.y,this}equals(t){return t.x===this.x&&t.y===this.y}nearEquals(t,s){return t.x.toFixed(s)===this.x.toFixed(s)&&t.y.toFixed(s)===this.y.toFixed(s)}lerp(t,s){return t===null?(this.x-=this.x*s,this.y-=this.y*s):(this.x+=(t.x-this.x)*s,this.y+=(t.y-this.y)*s),this}},m=class{constructor(t={}){if(this.main=t.main||null,this.isUI=t.isUI||!1,this.group=null,this.isListen=!1,this.ontop=t.ontop?t.ontop:!1,this.css=this.main?this.main.css:a.css,this.colors=this.main?this.main.colors:a.colors,this.defaultBorderColor=this.colors.border,this.svgs=a.svgs,this.isSpace=t.isSpace||!1,this.zone={x:0,y:0,w:0,h:0},this.local=new k().neg(),this.isCanvasOnly=!1,this.isSelect=!1,this.p=t.p!==void 0?t.p:a.size.p,this.w=this.isUI?this.main.size.w:a.size.w,t.w!==void 0&&(this.w=t.w),this.h=this.isUI?this.main.size.h:a.size.h,t.h!==void 0&&(this.h=t.h),this.isSpace||(this.h=this.h<11?11:this.h),this.autoWidth=t.auto||!0,this.isOpen=!1,this.radius=t.radius||this.colors.radius,this.isNumber=!1,this.noNeg=t.noNeg||!1,this.allEqual=t.allEqual||!1,this.mono=!1,this.isEdit=!1,this.simple=t.simple||!1,this.simple&&(this.sa=0),this.setSize(this.w),t.sa!==void 0&&(this.sa=t.sa),t.sb!==void 0&&(this.sb=t.sb),this.simple&&(this.sb=this.w-this.sa),this.sc=t.sc===void 0?47:t.sc,this.objectLink=null,this.isSend=!1,this.val=null,this.bg=this.colors.background,this.bgOver=this.colors.backgroundOver,t.bg!==void 0&&(this.bg=t.bg,this.bgOver=t.bg),t.bgOver!==void 0&&(this.bgOver=t.bgOver),this.titleColor=t.titleColor||this.colors.text,this.fontColor=t.fontColor||this.colors.text,this.fontSelect=t.fontSelect||this.colors.textOver,t.color!==void 0&&(this.fontColor=t.color),this.colorPlus=a.ColorLuma(this.fontColor,.3),this.txt=t.name||"",this.rename=t.rename||"",this.target=t.target||null,this.callback=t.callback===void 0?null:t.callback,this.endCallback=null,this.callback===null&&this.isUI&&this.main.callback!==null&&(this.callback=this.main.callback),this.c=[],this.s=[],this.c[0]=a.dom("div",this.css.basic+"position:relative; height:20px; float:left; overflow:hidden;"),this.s[0]=this.c[0].style,this.isUI&&(this.s[0].marginBottom="1px"),this.simple||(this.c[1]=a.dom("div",this.css.txt),this.s[1]=this.c[1].style,this.c[1].textContent=this.rename===""?this.txt:this.rename,this.s[1].color=this.titleColor),t.pos){this.s[0].position="absolute";for(let s in t.pos)this.s[0][s]=t.pos[s];this.mono=!0}t.css&&(this.s[0].cssText=t.css)}init(){this.zone.h=this.h;let t=this.s,s=this.c;t[0].height=this.h+"px",this.isUI&&(t[0].background=this.bg),s[1]!==void 0&&this.autoWidth&&(t[1]=s[1].style,t[1].height=this.h-4+"px",t[1].lineHeight=this.h-8+"px");let i=a.frag;for(let l=1,o=s.length;l!==o;l++)s[l]!==void 0&&(i.appendChild(s[l]),t[l]=s[l].style);let e=this.target!==null?this.target:this.isUI?this.main.inner:document.body;this.ontop?e.insertAdjacentElement("afterbegin",s[0]):e.appendChild(s[0]),s[0].appendChild(i),this.rSize(),this.isUI||(this.c[0].style.pointerEvents="auto",p.add(this))}dom(t,s,i,e,l){return a.dom(t,s,i,e,l)}setSvg(t,s,i,e,l){a.setSvg(t,s,i,e,l)}setCss(t,s){a.setCss(t,s)}clamp(t,s,i){return a.clamp(t,s,i)}getColorRing(){return a.colorRing||a.makeColorRing(),a.clone(a.colorRing)}getJoystick(t){return a["joystick_"+t]||a.makeJoystick(t),a.clone(a["joystick_"+t])}getCircular(t){return a.circular||a.makeCircular(t),a.clone(a.circular)}getKnob(t){return a.knob||a.makeKnob(t),a.clone(a.knob)}cursor(t){p.cursor(t)}update(){}reset(){}getDom(){return this.c[0]}uiout(){this.isSpace||this.s&&(this.s[0].background=this.bg)}uiover(){this.isSpace||this.s&&(this.s[0].background=this.bgOver)}rename(t){this.c[1]!==void 0&&(this.c[1].textContent=t)}listen(){return this.isListen=p.addListen(this),this}listening(){this.objectLink!==null&&(this.isSend||this.isEdit||this.setValue(this.objectLink[this.val]))}setValue(t){this.isNumber?this.value=this.numValue(t):this.value=t,this.update()}onChange(t){if(!this.isSpace)return this.callback=t||null,this}onFinishChange(t){if(!this.isSpace)return this.callback=null,this.endCallback=t,this}send(t){t=t||this.value,t instanceof Array&&t.length===1&&(t=t[0]),this.isSend=!0,this.objectLink!==null&&(this.objectLink[this.val]=t),this.callback&&this.callback(t,this.val),this.isSend=!1}sendEnd(t){t=t||this.value,t instanceof Array&&t.length===1&&(t=t[0]),this.endCallback&&this.endCallback(t),this.objectLink!==null&&(this.objectLink[this.val]=t)}clear(t){this.isListen&&p.removeListen(this),a.clear(this.c[0]),t||(this.target!==null?this.group!==null?this.group.clearOne(this):this.target.removeChild(this.c[0]):this.isUI?this.main.clearOne(this):document.body.removeChild(this.c[0]),this.isUI||p.remove(this)),this.c=null,this.s=null,this.callback=null,this.target=null,this.isListen=!1}setSize(t){if(!!this.autoWidth)if(this.w=t,this.simple)this.sb=this.w-this.sa;else{let s=this.w*(this.p/100);this.sa=Math.floor(s+10),this.sb=Math.floor(this.w-s-20)}}rSize(){!this.autoWidth||(this.s[0].width=this.w+"px",this.simple||(this.s[1].width=this.sa+"px"))}setTypeNumber(t){this.isNumber=!0,this.value=0,t.value!==void 0&&(typeof t.value=="string"?this.value=t.value*1:this.value=t.value),this.min=t.min===void 0?-Infinity:t.min,this.max=t.max===void 0?Infinity:t.max,this.precision=t.precision===void 0?2:t.precision;let s;switch(this.precision){case 0:s=1;break;case 1:s=.1;break;case 2:s=.01;break;case 3:s=.001;break;case 4:s=1e-4;break;case 5:s=1e-5;break}this.step=t.step===void 0?s:t.step,this.range=this.max-this.min,this.value=this.numValue(this.value)}numValue(t){return this.noNeg&&(t=Math.abs(t)),Math.min(this.max,Math.max(this.min,t)).toFixed(this.precision)*1}handleEvent(t){if(!this.isSpace)return this[t.type](t)}wheel(t){return!1}mousedown(t){return!1}mousemove(t){return!1}mouseup(t){return!1}keydown(t){return!1}click(t){return!1}keyup(t){return!1}setReferency(t,s){this.objectLink=t,this.val=s}display(t){t=t||!1,this.s[0].display=t?"block":"none"}open(){this.isOpen||(this.isOpen=!0)}close(){!this.isOpen||(this.isOpen=!1)}needZone(){p.needReZone=!0}rezone(){p.needReZone=!0}select(){}unselect(){}setInput(t){p.setInput(t,this)}upInput(t,s){return p.upInput(t,s)}selected(t){this.isSelect=t||!1}},P=class extends m{constructor(t={}){super(t);this.value=t.value||!1,this.buttonColor=t.bColor||this.colors.button,this.inh=t.inh||Math.floor(this.h*.8),this.inw=t.inw||36;let s=Math.floor(this.h*.5)-(this.inh-2)*.5;this.c[2]=this.dom("div",this.css.basic+"background:"+this.colors.boolbg+"; height:"+(this.inh-2)+"px; width:"+this.inw+"px; top:"+s+"px; border-radius:10px; border:2px solid "+this.boolbg),this.c[3]=this.dom("div",this.css.basic+"height:"+(this.inh-6)+"px; width:16px; top:"+(s+2)+"px; border-radius:10px; background:"+this.buttonColor+";"),this.init(),this.update()}mousemove(t){this.cursor("pointer")}mousedown(t){return this.value=!this.value,this.update(),this.send(),!0}update(){let t=this.s;this.value?(t[2].background=this.colors.boolon,t[2].borderColor=this.colors.boolon,t[3].marginLeft="17px"):(t[2].background=this.colors.boolbg,t[2].borderColor=this.colors.boolbg,t[3].marginLeft="2px")}rSize(){super.rSize();let t=this.s,s=this.w-10-this.inw;t[2].left=s+"px",t[3].left=s+"px"}},E=class extends m{constructor(t={}){super(t);this.value=!1,this.values=t.value||this.txt,this.onName=t.onName||"",this.on=!1,typeof this.values=="string"&&(this.values=[this.values]),this.isDown=!1,this.isLink=t.link||!1,this.cc=[this.colors.button,this.colors.select,this.colors.down],t.cBg!==void 0&&(this.cc[0]=t.cBg),t.bColor!==void 0&&(this.cc[0]=t.bColor),t.cSelect!==void 0&&(this.cc[1]=t.cSelect),t.cDown!==void 0&&(this.cc[2]=t.cDown),this.isLoadButton=t.loader||!1,this.isDragButton=t.drag||!1,this.isDragButton&&(this.isLoadButton=!0),this.lng=this.values.length,this.tmp=[],this.stat=[];for(let s=0;s<this.lng;s++)this.c[s+2]=this.dom("div",this.css.txt+this.css.button+"top:1px; background:"+this.cc[0]+"; height:"+(this.h-2)+"px; border:"+this.colors.buttonBorder+"; border-radius:"+this.radius+"px;"),this.c[s+2].style.color=this.fontColor,this.c[s+2].innerHTML=this.values[s],this.stat[s]=1;this.c[1]!==void 0&&(this.c[1].textContent=""),this.isLoadButton&&this.initLoader(),this.isDragButton&&(this.lng++,this.initDrager()),this.init()}onOff(){this.on=!this.on,this.c[2].innerHTML=this.on?this.onName:this.values[0]}testZone(t){let s=this.local;if(s.x===-1&&s.y===-1)return"";let i=this.lng,e=this.tmp;for(;i--;)if(s.x>e[i][0]&&s.x<e[i][2])return i+2;return""}click(t){if(this.onName!==""&&this.onOff(),this.isLink){let s=this.testZone(t);return s?(this.value=this.values[s-2],this.send(),this.reset()):!1}}mouseup(t){return this.isDown?(this.value=!1,this.isDown=!1,this.mousemove(t)):!1}mousedown(t){if(this.isLink)return!1;let s=this.testZone(t);return s?(this.isDown=!0,this.value=this.values[s-2],this.isLoadButton||this.send(),this.mousemove(t)):!1}mousemove(t){let s=!1,i=this.testZone(t);return i!==""?(this.cursor("pointer"),s=this.modes(this.isDown?3:2,i)):s=this.reset(),s}modes(t,s){let i,e=!1;for(let l=0;l<this.lng;l++)l===s-2?i=this.mode(t,l+2):i=this.mode(1,l+2),i&&(e=!0);return e}mode(t,s){let i=!1,e=s-2;if(this.stat[e]!==t){switch(t){case 1:this.stat[e]=1,this.s[e+2].color=this.fontColor,this.s[e+2].background=this.cc[0];break;case 2:this.stat[e]=2,this.s[e+2].color=this.fontSelect,this.s[e+2].background=this.cc[1];break;case 3:this.stat[e]=3,this.s[e+2].color=this.fontSelect,this.s[e+2].background=this.cc[2];break}i=!0}return i}reset(){return this.cursor(),this.modes(1,2)}dragover(t){t.preventDefault(),this.s[4].borderColor=this.colors.select,this.s[4].color=this.colors.select}dragend(t){t.preventDefault(),this.s[4].borderColor=this.fontColor,this.s[4].color=this.fontColor}drop(t){t.preventDefault(),this.dragend(t),this.fileSelect(t.dataTransfer.files[0])}initDrager(){this.c[4]=this.dom("div",this.css.txt+" text-align:center; line-height:"+(this.h-8)+"px; border:1px dashed "+this.fontColor+"; top:2px;  height:"+(this.h-4)+"px; border-radius:"+this.radius+"px; pointer-events:auto;"),this.c[4].textContent="DRAG",this.c[4].addEventListener("dragover",function(t){this.dragover(t)}.bind(this),!1),this.c[4].addEventListener("dragend",function(t){this.dragend(t)}.bind(this),!1),this.c[4].addEventListener("dragleave",function(t){this.dragend(t)}.bind(this),!1),this.c[4].addEventListener("drop",function(t){this.drop(t)}.bind(this),!1)}initLoader(){this.c[3]=this.dom("input",this.css.basic+"top:0px; opacity:0; height:"+this.h+"px; pointer-events:auto; cursor:pointer;"),this.c[3].name="loader",this.c[3].type="file",this.c[3].addEventListener("change",function(t){this.fileSelect(t.target.files[0])}.bind(this),!1)}fileSelect(t){let s=["png","jpg","mp4","webm","ogg"],i=["sea","z","hex","bvh","BVH","glb"];if(t===void 0)return;let e=new FileReader,l=t.name,o=l.substring(l.lastIndexOf(".")+1,l.length);s.indexOf(o)!==-1?e.readAsDataURL(t):i.indexOf(o)!==-1?e.readAsArrayBuffer(t):e.readAsText(t),e.onload=function(u){this.callback&&this.callback(u.target.result,l,o)}.bind(this)}label(t,s){s=s||2,this.c[s].textContent=t}icon(t,s,i){i=i||2,this.s[i].padding=(s||0)+"px 0px",this.c[i].innerHTML=t}rSize(){super.rSize();let t=this.s,s=this.sb,i=this.sa,e=this.lng,l=3,o=Math.floor((s-l*(e-1))/e);for(;e--;)this.tmp[e]=[Math.floor(i+o*e+l*e),o],this.tmp[e][2]=this.tmp[e][0]+this.tmp[e][1],t[e+2].left=this.tmp[e][0]+"px",t[e+2].width=this.tmp[e][1]+"px";this.isDragButton&&(t[4].left=i+o+l+"px",t[4].width=o+"px"),this.isLoadButton&&(t[3].left=i+"px",t[3].width=o+"px")}},Z=class extends m{constructor(t={}){super(t);this.isCyclic=t.cyclic||!1,this.autoWidth=!1,this.buttonColor=this.colors.button,this.setTypeNumber(t),this.radius=this.w*.5,this.twoPi=Math.PI*2,this.pi90=Math.PI*.5,this.offset=new k,this.h=t.h||this.w+10,this.top=0,this.c[0].style.width=this.w+"px",this.c[1]!==void 0&&(this.c[1].style.width=this.w+"px",this.c[1].style.textAlign="center",this.top=10,this.h+=10),this.percent=0,this.cmode=0,this.c[2]=this.dom("div",this.css.txt+"text-align:center; top:"+(this.h-20)+"px; width:"+this.w+"px; color:"+this.fontColor),this.c[3]=this.getCircular(),this.setSvg(this.c[3],"d",this.makePath(),1),this.setSvg(this.c[3],"stroke",this.fontColor,1),this.setSvg(this.c[3],"viewBox","0 0 "+this.w+" "+this.w),this.setCss(this.c[3],{width:this.w,height:this.w,left:0,top:this.top}),this.init(),this.update()}mode(t){if(this.cmode===t)return!1;switch(t){case 0:this.s[2].color=this.fontColor,this.setSvg(this.c[3],"stroke","rgba(0,0,0,0.1)",0),this.setSvg(this.c[3],"stroke",this.fontColor,1);break;case 1:this.s[2].color=this.colorPlus,this.setSvg(this.c[3],"stroke","rgba(0,0,0,0.3)",0),this.setSvg(this.c[3],"stroke",this.colorPlus,1);break}return this.cmode=t,!0}reset(){this.isDown=!1}testZone(t){let s=this.local;return s.x===-1&&s.y===-1?"":s.y<=this.c[1].offsetHeight?"title":s.y>this.h-this.c[2].offsetHeight?"text":"circular"}mouseup(t){return this.isDown=!1,this.sendEnd(),this.mode(0)}mousedown(t){return this.isDown=!0,this.old=this.value,this.oldr=null,this.mousemove(t),this.mode(1)}mousemove(t){if(!!this.isDown){var s=this.offset;if(s.x=this.radius-(t.clientX-this.zone.x),s.y=this.radius-(t.clientY-this.zone.y-this.top),this.r=s.angle()-this.pi90,this.r=(this.r%this.twoPi+this.twoPi)%this.twoPi,this.oldr!==null){var i=this.r-this.oldr;this.r=Math.abs(i)>Math.PI?this.oldr:this.r,i>6&&(this.r=0),i<-6&&(this.r=this.twoPi)}var e=1/this.twoPi,l=this.r*e,o=this.range*l+this.min-this.old;(o>=this.step||o<=this.step)&&(o=~~(o/this.step),this.value=this.numValue(this.old+o*this.step),this.update(!0),this.old=this.value,this.oldr=this.r)}}wheel(t){if(this.testZone(t)==="circular"){let i=this.value-this.step*t.delta;return i>this.max?i=this.isCyclic?this.min:this.max:i<this.min&&(i=this.isCyclic?this.max:this.min),this.setValue(i),this.old=i,this.update(!0),!0}return!1}makePath(){var t=40,s=24,i=this.percent*this.twoPi-.001,e=t+t*Math.sin(i)+s,l=t-t*Math.cos(i)+s,o=i>Math.PI?1:0;return"M "+(t+s)+","+s+" A "+t+","+t+" 0 "+o+" 1 "+e+","+l}update(t){this.c[2].textContent=this.value,this.percent=(this.value-this.min)/this.range,this.setSvg(this.c[3],"d",this.makePath(),1),t&&this.send()}},R=class extends m{constructor(t={}){super(t);this.ctype=t.ctype||"hex",this.wfixe=256,this.cw=this.sb>256?256:this.sb,t.cw!=null&&(this.cw=t.cw),this.side=t.side||"down",this.up=this.side==="down"?0:1,this.baseH=this.h,this.offset=new k,this.decal=new k,this.pp=new k,this.c[2]=this.dom("div",this.css.txt+"height:"+(this.h-4)+"px;border-radius:"+this.radius+"px; line-height:"+(this.h-8)+"px;"),this.s[2]=this.c[2].style,this.up&&(this.s[2].top="auto",this.s[2].bottom="2px"),this.c[3]=this.getColorRing(),this.c[3].style.visibility="hidden",this.hsl=null,this.value="#ffffff",t.value!==void 0&&(t.value instanceof Array?this.value=a.rgbToHex(t.value):isNaN(t.value)?this.value=t.value:this.value=a.hexToHtml(t.value)),this.bcolor=null,this.isDown=!1,this.fistDown=!1,this.tr=98,this.tsl=Math.sqrt(3)*this.tr,this.hue=0,this.d=256,this.setColor(this.value),this.init(),t.open!==void 0&&this.open()}testZone(t,s){let i=this.local;if(i.x===-1&&i.y===-1)return"";if(this.up&&this.isOpen)return i.y>this.wfixe?"title":"color";if(i.y<this.baseH+2)return"title";if(this.isOpen)return"color"}mouseup(t){this.isDown=!1,this.d=256}mousedown(t){let s=this.testZone(t.clientX,t.clientY);if(s==="title")return this.isOpen?this.close():this.open(),!0;s==="color"&&(this.isDown=!0,this.fistDown=!0,this.mousemove(t))}mousemove(t){let s=this.testZone(t.clientX,t.clientY),i,e,l,o,u,c,f,x,g,d=a;if(s==="title"&&this.cursor("pointer"),s==="color"&&(i=this.offset,i.x=t.clientX-(this.zone.x+this.decal.x+this.mid),i.y=t.clientY-(this.zone.y+this.decal.y+this.mid),e=i.length()*this.ratio,g=i.angle(),g<0&&(g+=2*d.PI),e<128?this.cursor("crosshair"):this.isDown||this.cursor(),this.isDown&&(this.fistDown&&(this.d=e,this.fistDown=!1),this.d<128)))if(this.d>this.tr)l=(g+d.pi90)/d.TwoPI,this.hue=(l+1)%1,this.setHSL([(l+1)%1,this.hsl[1],this.hsl[2]]);else{f=i.x*this.ratio,x=i.y*this.ratio;let b=this.hue*d.TwoPI+d.PI;b<0&&(b+=2*d.PI),c=Math.atan2(-x,f),c<0&&(c+=2*d.PI);let v=(c+d.pi90+d.TwoPI+b)%d.TwoPI,C=v%(2/3*d.PI)-d.pi60,w=.5*this.tr,y=Math.tan(C)*w,S=Math.sqrt(f*f+x*x),I=Math.sqrt(w*w+y*y);if(S>I){let tt=Math.tan(C)*S,M=Math.atan(tt/I);M>d.pi60?M=d.pi60:M<-d.pi60&&(M=-d.pi60),c+=M-C,v=(c+d.pi90+d.TwoPI+b)%d.TwoPI,C=v%(2/3*d.PI)-d.pi60,y=Math.tan(C)*w,S=I=Math.sqrt(w*w+y*y)}u=Math.sin(v)*S/this.tsl+.5;let $=1-Math.abs(u-.5)*2;o=(Math.cos(v)*S+this.tr/2)/(1.5*this.tr)/$,o=d.clamp(o,0,1),this.setHSL([this.hsl[0],o,u])}}setHeight(){this.h=this.isOpen?this.wfixe+this.baseH+5:this.baseH,this.s[0].height=this.h+"px",this.zone.h=this.h}parentHeight(t){this.group!==null?this.group.calc(t):this.isUI&&this.main.calc(t)}open(){super.open(),this.setHeight(),this.up&&(this.zone.y-=this.wfixe+5);let t=this.h-this.baseH;this.s[3].visibility="visible",this.parentHeight(t)}close(){super.close(),this.up&&(this.zone.y+=this.wfixe+5);let t=this.h-this.baseH;this.setHeight(),this.s[3].visibility="hidden",this.parentHeight(-t)}update(t){let s=a.rgbToHex(a.hslToRgb([this.hsl[0],1,.5]));this.moveMarkers(),this.value=this.bcolor,this.setSvg(this.c[3],"fill",s,2,0),this.s[2].background=this.bcolor,this.c[2].textContent=a.htmlToHex(this.bcolor),this.invert=a.findDeepInver(this.rgb),this.s[2].color=this.invert?"#fff":"#000",!!t&&(this.ctype==="array"&&this.send(this.rgb),this.ctype==="rgb"&&this.send(a.htmlRgb(this.rgb)),this.ctype==="hex"&&this.send(a.htmlToHex(this.value)),this.ctype==="html"&&this.send())}setColor(t){let s=a.unpack(t);return this.bcolor!=t&&s&&(this.bcolor=t,this.rgb=s,this.hsl=a.rgbToHsl(this.rgb),this.hue=this.hsl[0],this.update()),this}setHSL(t){return this.hsl=t,this.rgb=a.hslToRgb(t),this.bcolor=a.rgbToHex(this.rgb),this.update(!0),this}moveMarkers(){let t=this.pp,s=a;this.invert;let i=this.hsl[0]*s.TwoPI,e=2/3*s.PI,l=this.tr,o=this.hsl[0],u=this.hsl[1],c=this.hsl[2],f=(i-s.pi90)*s.todeg;o=-i+s.pi90;let x=Math.cos(o)*l,g=-Math.sin(o)*l,d=Math.cos(o-e)*l,b=-Math.sin(o-e)*l,v=Math.cos(o+e)*l,C=-Math.sin(o+e)*l,w=(d+v)/2,y=(b+C)/2;i=(1-2*Math.abs(c-.5))*u;let S=d+(v-d)*c+(x-w)*i,I=b+(C-b)*c+(g-y)*i;t.set(S,I).addScalar(128),this.setSvg(this.c[3],"transform","rotate("+f+" )",2),this.setSvg(this.c[3],"cx",t.x,3),this.setSvg(this.c[3],"cy",t.y,3),this.setSvg(this.c[3],"stroke",this.invert?"#fff":"#000",2,3),this.setSvg(this.c[3],"stroke",this.invert?"#fff":"#000",3),this.setSvg(this.c[3],"fill",this.bcolor,3)}rSize(){super.rSize();let t=this.s;t[2].width=this.sb+"px",t[2].left=this.sa+"px",this.rSizeColor(this.cw),this.decal.x=Math.floor((this.w-this.wfixe)*.5),t[3].left=this.decal.x+"px"}rSizeColor(t){if(t===this.wfixe)return;this.wfixe=t;let s=this.s;this.decal.y=this.side==="up"?2:this.baseH+2,this.mid=Math.floor(this.wfixe*.5),this.setSvg(this.c[3],"viewBox","0 0 "+this.wfixe+" "+this.wfixe),s[3].width=this.wfixe+"px",s[3].height=this.wfixe+"px",s[3].top=this.decal.y+"px",this.ratio=256/this.wfixe,this.square=1/(60*(this.wfixe/256)),this.setHeight()}},A=class extends m{constructor(t={}){super(t);this.round=Math.round,this.baseH=this.h,this.hplus=t.hplus||50,this.res=t.res||40,this.l=1,this.precision=t.precision||0,this.custom=t.custom||!1,this.names=t.names||["FPS","MS"];let s=t.cc||["220,220,220","255,255,0"];this.adding=t.adding||!1,this.range=t.range||[165,100,100],this.alpha=t.alpha||.25,this.values=[],this.points=[],this.textDisplay=[],this.custom||(this.now=self.performance&&self.performance.now?self.performance.now.bind(performance):Date.now,this.startTime=0,this.prevTime=0,this.frames=0,this.ms=0,this.fps=0,this.mem=0,this.mm=0,this.isMem=!!(self.performance&&self.performance.memory),this.isMem&&(this.names.push("MEM"),s.push("0,255,255")),this.txt=t.name||"Fps");let i=Math.floor(this.h*.5)-6;this.c[1].textContent=this.txt,this.c[0].style.cursor="pointer",this.c[0].style.pointerEvents="auto";let e="display:none; left:10px; top:"+this.h+"px; height:"+(this.hplus-8)+"px; box-sizing:border-box; background: rgba(0, 0, 0, 0.2); border:"+(this.colors.groupBorder!=="none"?this.colors.groupBorder+";":"1px solid rgba(255, 255, 255, 0.2);");this.radius!==0&&(e+="border-radius:"+this.radius+"px;"),this.c[2]=this.dom("path",this.css.basic+e,{}),this.c[2].setAttribute("viewBox","0 0 "+this.res+" 50"),this.c[2].setAttribute("height","100%"),this.c[2].setAttribute("width","100%"),this.c[2].setAttribute("preserveAspectRatio","none"),this.c[3]=this.dom("path",this.css.basic+"position:absolute; width:10px; height:10px; left:4px; top:"+i+"px;",{d:this.svgs.arrow,fill:this.fontColor,stroke:"none"}),this.c[4]=this.dom("div",this.css.txt+"position:absolute; left:10px; top:"+(this.h+2)+"px; display:none; width:100%; text-align:center;"),t.bottomLine&&(this.c[4]=this.dom("div",this.css.basic+"width:100%; bottom:0px; height:1px; background: rgba(255, 255, 255, 0.2);")),this.isShow=!1;let l=this.s;l[1].marginLeft="10px",l[1].lineHeight=this.h-4,l[1].color=this.fontColor,l[1].fontWeight="bold",this.radius!==0&&(l[0].borderRadius=this.radius+"px"),l[0].border=this.colors.groupBorder;let o=0;for(o=0;o<this.names.length;o++){let u=[],c=this.res+1;for(;c--;)u.push(50);this.range[o]=1/this.range[o]*49,this.points.push(u),this.values.push(0),this.textDisplay.push("<span style='color:rgb("+s[o]+")'> "+this.names[o]+" ")}for(o=this.names.length;o--;)this.dom("path",null,{fill:"rgba("+s[o]+","+this.alpha+")","stroke-width":1,stroke:"rgba("+s[o]+",1)","vector-effect":"non-scaling-stroke"},this.c[2]);this.init()}mousedown(t){this.isShow?this.close():this.open()}tick(t){this.values=t,!!this.isShow&&(this.drawGraph(),this.upText())}makePath(t){let s="";s+="M "+-1+" "+50;for(let i=0;i<this.res+1;i++)s+=" L "+i+" "+t[i];return s+=" L "+(this.res+1)+" "+50,s}upText(t){let s=t||this.values,i="";for(let e=0,l=this.names.length;e<l;e++)i+=this.textDisplay[e]+s[e].toFixed(this.precision)+"</span>";this.c[4].innerHTML=i}drawGraph(){let t=this.c[2],s=this.names.length,i,e=0,l=0;for(;s--;)this.adding?i=(this.values[l]+e)*this.range[l]:i=this.values[l]*this.range[l],this.points[l].shift(),this.points[l].push(50-i),this.setSvg(t,"d",this.makePath(this.points[l]),s+1),e+=this.values[l],l++}open(){super.open(),this.h=this.hplus+this.baseH,this.setSvg(this.c[3],"d",this.svgs.arrowDown),this.group!==null?this.group.calc(this.hplus):this.isUI&&this.main.calc(this.hplus),this.s[0].height=this.h+"px",this.s[2].display="block",this.s[4].display="block",this.isShow=!0,this.custom||p.addListen(this)}close(){super.close(),this.h=this.baseH,this.setSvg(this.c[3],"d",this.svgs.arrow),this.group!==null?this.group.calc(-this.hplus):this.isUI&&this.main.calc(-this.hplus),this.s[0].height=this.h+"px",this.s[2].display="none",this.s[4].display="none",this.isShow=!1,this.custom||p.removeListen(this),this.c[4].innerHTML=""}begin(){this.startTime=this.now()}end(){let t=this.now();if(this.ms=t-this.startTime,this.frames++,t>this.prevTime+1e3&&(this.fps=this.round(this.frames*1e3/(t-this.prevTime)),this.prevTime=t,this.frames=0,this.isMem)){let s=performance.memory.usedJSHeapSize,i=performance.memory.jsHeapSizeLimit;this.mem=this.round(s*954e-9),this.mm=s/i}return this.values=[this.fps,this.ms,this.mm],this.drawGraph(),this.upText([this.fps,this.ms,this.mem]),t}listening(){this.custom||(this.startTime=this.end())}rSize(){let t=this.s,s=this.w;t[0].width=s+"px",t[1].width=s+"px",t[2].left=10+"px",t[2].width=s-20+"px",t[4].width=s-20+"px"}},N=class extends m{constructor(t={}){super(t);this.value=t.value!==void 0?t.value:[0,0,0],this.lng=this.value.length,this.precision=t.precision!==void 0?t.precision:2,this.multiplicator=t.multiplicator||1,this.neg=t.neg||!1,this.line=t.line!==void 0?t.line:!0,this.autoWidth=t.autoWidth!==void 0?t.autoWidth:!0,this.isNumber=!1,this.isDown=!1,this.h=t.h||128+10,this.rh=this.h-10,this.top=0,this.c[0].style.width=this.w+"px",this.c[1]!==void 0&&(this.c[1].style.width=this.w+"px",this.top=10,this.h+=10),this.gh=this.rh-28,this.gw=this.w-28,this.c[2]=this.dom("div",this.css.txt+"text-align:center; top:"+(this.h-20)+"px; width:"+this.w+"px; color:"+this.fontColor),this.c[2].textContent=this.value;let s=this.dom("svg",this.css.basic,{viewBox:"0 0 "+this.w+" "+this.rh,width:this.w,height:this.rh,preserveAspectRatio:"none"});this.setCss(s,{width:this.w,height:this.rh,left:0,top:this.top}),this.dom("path","",{d:"",stroke:this.colors.text,"stroke-width":2,fill:"none","stroke-linecap":"butt"},s),this.dom("rect","",{x:10,y:10,width:this.gw+8,height:this.gh+8,stroke:"rgba(0,0,0,0.3)","stroke-width":1,fill:"none"},s),this.iw=(this.gw-4*(this.lng-1))/this.lng;let i=[];this.cMode=[],this.v=[];for(let e=0;e<this.lng;e++)i[e]=[14+e*this.iw+e*4,this.iw],i[e][2]=i[e][0]+i[e][1],this.cMode[e]=0,this.neg?this.v[e]=(1+this.value[e]/this.multiplicator)*.5:this.v[e]=this.value[e]/this.multiplicator,this.dom("rect","",{x:i[e][0],y:14,width:i[e][1],height:1,fill:this.fontColor,"fill-opacity":.3},s);this.tmp=i,this.c[3]=s,this.init(),this.c[1]!==void 0&&(this.c[1].style.top=0+"px",this.c[1].style.height=20+"px",this.s[1].lineHeight=20-5+"px"),this.update(!1)}updateSVG(){this.line&&this.setSvg(this.c[3],"d",this.makePath(),0);for(let t=0;t<this.lng;t++)this.setSvg(this.c[3],"height",this.v[t]*this.gh,t+2),this.setSvg(this.c[3],"y",14+(this.gh-this.v[t]*this.gh),t+2),this.neg?this.value[t]=((this.v[t]*2-1)*this.multiplicator).toFixed(this.precision)*1:this.value[t]=(this.v[t]*this.multiplicator).toFixed(this.precision)*1;this.c[2].textContent=this.value}testZone(t){let s=this.local;if(s.x===-1&&s.y===-1)return"";let i=this.lng,e=this.tmp;if(s.y>this.top&&s.y<this.h-20){for(;i--;)if(s.x>e[i][0]&&s.x<e[i][2])return i}return""}mode(t,s){if(t===this.cMode[s])return!1;let i;switch(t){case 0:i=.3;break;case 1:i=.6;break;case 2:i=1;break}return this.reset(),this.setSvg(this.c[3],"fill-opacity",i,s+2),this.cMode[s]=t,!0}reset(){let t=!1,s=this.lng;for(;s--;)this.cMode[s]!==0&&(this.cMode[s]=0,this.setSvg(this.c[3],"fill-opacity",.3,s+2),t=!0);return t}mouseup(t){if(this.isDown=!1,this.current!==-1)return this.reset()}mousedown(t){return this.isDown=!0,this.mousemove(t)}mousemove(t){let s=!1,i=this.testZone(t);return i===""?s=this.reset():(s=this.mode(this.isDown?2:1,i),this.isDown&&(this.v[i]=this.clamp(1-(t.clientY-this.zone.y-this.top-10)/this.gh,0,1),this.update(!0))),s}update(t){this.updateSVG(),t&&this.send()}makePath(){let t="",s,i,e,l,o,u;for(let c=0;c<this.lng;c++)s=14+(this.gh-this.v[c]*this.gh),i=14+c*this.iw+c*4,l=i+this.iw*.5,e=i+this.iw,c===0?t+="M "+i+" "+s+" T "+l+" "+s:t+=" C "+o+" "+u+","+i+" "+s+","+l+" "+s,c===this.lng-1&&(t+=" T "+e+" "+s),o=e,u=s;return t}rSize(){super.rSize();let t=this.s;this.c[1]!==void 0&&(t[1].width=this.w+"px"),t[2].width=this.w+"px",t[3].width=this.w+"px";let i=(this.w-28-4*(this.lng-1))/this.lng,e=[];for(let l=0;l<this.lng;l++)e[l]=[14+l*i+l*4,i],e[l][2]=e[l][0]+e[l][1];this.tmp=e}},H=class extends m{constructor(t={}){super(t);this.ADD=t.add,this.uis=[],this.isEmpty=!0,this.autoHeight=!0,this.current=-1,this.target=null,this.decal=0,this.baseH=this.h;let s=Math.floor(this.h*.5)-6;this.isLine=t.line!==void 0?t.line:!1,this.c[2]=this.dom("div",this.css.basic+"width:100%; left:0; height:auto; overflow:hidden; top:"+this.h+"px"),this.c[3]=this.dom("path",this.css.basic+"position:absolute; width:10px; height:10px; left:0; top:"+s+"px;",{d:this.svgs.group,fill:this.fontColor,stroke:"none"}),this.c[4]=this.dom("path",this.css.basic+"position:absolute; width:10px; height:10px; left:4px; top:"+s+"px;",{d:this.svgs.arrow,fill:this.fontColor,stroke:"none"}),this.isLine&&(this.c[5]=this.dom("div",this.css.basic+"background:rgba(255, 255, 255, 0.2); width:100%; left:0; height:1px; bottom:0px"));let i=this.s;i[0].height=this.h+"px",i[1].height=this.h+"px",this.c[1].name="group",i[1].marginLeft="10px",i[1].lineHeight=this.h-4,i[1].color=this.fontColor,i[1].fontWeight="bold",this.radius!==0&&(i[0].borderRadius=this.radius+"px"),i[0].border=this.colors.groupBorder,this.init(),this.setBG(this.bg),t.open!==void 0&&this.open()}testZone(t){let s=this.local;if(s.x===-1&&s.y===-1)return"";let i="";return s.y<this.baseH?i="title":this.isOpen&&(i="content"),i}clearTarget(){return this.current===-1?!1:(this.target.uiout(),this.target.reset(),this.current=-1,this.target=null,this.cursor(),!0)}reset(){this.clearTarget()}handleEvent(t){let s=t.type,i=!1,e=!1,l=this.testZone(t);if(!!l){switch(l){case"content":this.cursor(),p.isMobile&&s==="mousedown"&&this.getNext(t,i),this.target&&(e=this.target.handleEvent(t)),p.lock||this.getNext(t,i);break;case"title":this.cursor("pointer"),s==="mousedown"&&(this.isOpen?this.close():this.open());break}return this.isDown&&(i=!0),e&&(i=!0),i}}getNext(t,s){let i=p.findTarget(this.uis,t);i!==this.current&&(this.clearTarget(),this.current=i),i!==-1&&(this.target=this.uis[this.current],this.target.uiover())}calcH(){let t=this.uis.length,s,i,e=0,l=0,o=0;for(s=0;s<t;s++)i=this.uis[s],i.autoWidth?e+=i.h+1:(l===0?e+=i.h+1:o<i.h&&(e+=i.h-o),o=i.h,l+=i.w,l+i.w>this.w&&(l=0));return e}calcUis(){!this.isOpen||p.calcUis(this.uis,this.zone,this.zone.y+this.baseH)}setBG(t){this.s[0].background=t;let s=this.uis.length;for(;s--;)this.uis[s].setBG(t)}add(){let t=arguments;typeof t[1]=="object"?(t[1].isUI=this.isUI,t[1].target=this.c[2],t[1].main=this.main):typeof arguments[1]=="string"&&(t[2]===void 0?[].push.call(t,{isUI:!0,target:this.c[2],main:this.main}):(t[2].isUI=!0,t[2].target=this.c[2],t[2].main=this.main));let s=this.ADD.apply(this,t);return this.uis.push(s),s.group=this,this.isEmpty=!1,s}remove(t){t.clear&&t.clear()}empty(){this.close();let t=this.uis.length,s;for(;t--;)s=this.uis.pop(),this.c[2].removeChild(s.c[0]),s.clear(!0);this.isEmpty=!0,this.h=this.baseH}clearOne(t){let s=this.uis.indexOf(t);s!==-1&&(this.calc(-(this.uis[s].h+1)),this.c[2].removeChild(this.uis[s].c[0]),this.uis.splice(s,1),this.uis.length===0&&(this.isEmpty=!0,this.close()))}parentHeight(t){this.group!==null?this.group.calc(t):this.isUI&&this.main.calc(t)}open(){super.open(),this.setSvg(this.c[4],"d",this.svgs.arrowDown),this.rSizeContent();let t=this.h-this.baseH;this.parentHeight(t)}close(){super.close();let t=this.h-this.baseH;this.setSvg(this.c[4],"d",this.svgs.arrow),this.h=this.baseH,this.s[0].height=this.h+"px",this.parentHeight(-t)}clear(){this.empty(),this.isUI&&this.main.calc(-(this.h+1)),m.prototype.clear.call(this)}clearGroup(){this.empty()}calc(t){!this.isOpen||(t!==void 0?(this.h+=t,this.isUI&&this.main.calc(t)):this.h=this.calcH()+this.baseH,this.s[0].height=this.h+"px")}rSizeContent(){let t=this.uis.length;for(;t--;)this.uis[t].setSize(this.w),this.uis[t].rSize();this.calc()}rSize(){super.rSize();let t=this.s;t[3].left=this.sa+this.sb-17+"px",t[1].width=this.w+"px",t[2].width=this.w+"px",this.isOpen&&this.rSizeContent()}};H.prototype.isGroup=!0;var B=class extends m{constructor(t={}){super(t);this.autoWidth=!1,this.value=[0,0],this.joyType="analogique",this.model=t.mode!==void 0?t.mode:0,this.precision=t.precision||2,this.multiplicator=t.multiplicator||1,this.pos=new k,this.tmp=new k,this.interval=null,this.radius=this.w*.5,this.distance=this.radius*.25,this.h=t.h||this.w+10,this.top=0,this.c[0].style.width=this.w+"px",this.c[1]!==void 0&&(this.c[1].style.width=this.w+"px",this.c[1].style.textAlign="center",this.top=10,this.h+=10),this.c[2]=this.dom("div",this.css.txt+"text-align:center; top:"+(this.h-20)+"px; width:"+this.w+"px; color:"+this.fontColor),this.c[2].textContent=this.value,this.c[3]=this.getJoystick(this.model),this.setSvg(this.c[3],"viewBox","0 0 "+this.w+" "+this.w),this.setCss(this.c[3],{width:this.w,height:this.w,left:0,top:this.top}),this.ratio=128/this.w,this.init(),this.update(!1)}mode(t){switch(t){case 0:this.model===0?(this.setSvg(this.c[3],"fill","url(#gradIn)",4),this.setSvg(this.c[3],"stroke","#000",4)):(this.setSvg(this.c[3],"stroke","rgba(100,100,100,0.25)",2),this.setSvg(this.c[3],"stroke","#666",4),this.setSvg(this.c[3],"fill","none",4));break;case 1:this.model===0?(this.setSvg(this.c[3],"fill","url(#gradIn2)",4),this.setSvg(this.c[3],"stroke","rgba(0,0,0,0)",4)):(this.setSvg(this.c[3],"stroke","rgba(48,138,255,0.25)",2),this.setSvg(this.c[3],"stroke",this.colors.select,4),this.setSvg(this.c[3],"fill","rgba(48,138,255,0.25)",4));break}}addInterval(){this.interval!==null&&this.stopInterval(),!this.pos.isZero()&&(this.interval=setInterval(function(){this.update()}.bind(this),10))}stopInterval(){this.interval!==null&&(clearInterval(this.interval),this.interval=null)}reset(){this.addInterval(),this.mode(0)}mouseup(t){this.addInterval(),this.isDown=!1}mousedown(t){this.isDown=!0,this.mousemove(t),this.mode(2)}mousemove(t){if(this.mode(1),!this.isDown)return;if(this.tmp.x=this.radius-(t.clientX-this.zone.x),this.tmp.y=this.radius-(t.clientY-this.zone.y-this.top),this.tmp.length()>this.distance){let i=Math.atan2(this.tmp.x,this.tmp.y);this.tmp.x=Math.sin(i)*this.distance,this.tmp.y=Math.cos(i)*this.distance}this.pos.copy(this.tmp).divideScalar(this.distance).negate(),this.update()}setValue(t){t===void 0&&(t=[0,0]),this.pos.set(t[0]||0,t[1]||0),this.updateSVG()}update(t){t===void 0&&(t=!0),this.interval!==null&&(this.isDown||(this.pos.lerp(null,.3),this.pos.x=Math.abs(this.pos.x)<.01?0:this.pos.x,this.pos.y=Math.abs(this.pos.y)<.01?0:this.pos.y,this.isUI&&this.main.isCanvas&&this.main.draw())),this.updateSVG(),t&&this.send(),this.pos.isZero()&&this.stopInterval()}updateSVG(){let t=this.radius- -this.pos.x*this.distance,s=this.radius- -this.pos.y*this.distance;if(this.model===0){let i=t+this.pos.x*5+5,e=s+this.pos.y*5+10;this.setSvg(this.c[3],"cx",i*this.ratio,3),this.setSvg(this.c[3],"cy",e*this.ratio,3)}else this.setSvg(this.c[3],"cx",t*this.ratio,3),this.setSvg(this.c[3],"cy",s*this.ratio,3);this.setSvg(this.c[3],"cx",t*this.ratio,4),this.setSvg(this.c[3],"cy",s*this.ratio,4),this.value[0]=(this.pos.x*this.multiplicator).toFixed(this.precision)*1,this.value[1]=(this.pos.y*this.multiplicator).toFixed(this.precision)*1,this.c[2].textContent=this.value}clear(){this.stopInterval(),super.clear()}},F=class extends m{constructor(t={}){super(t);this.isCyclic=t.cyclic||!1,this.autoWidth=!1,this.buttonColor=this.colors.button,this.setTypeNumber(t),this.mPI=Math.PI*.8,this.toDeg=180/Math.PI,this.cirRange=this.mPI*2,this.offset=new k,this.radius=this.w*.5,this.h=t.h||this.w+10,this.top=0,this.c[0].style.width=this.w+"px",this.c[1]!==void 0&&(this.c[1].style.width=this.w+"px",this.c[1].style.textAlign="center",this.top=10,this.h+=10),this.percent=0,this.cmode=0,this.c[2]=this.dom("div",this.css.txt+"text-align:center; top:"+(this.h-20)+"px; width:"+this.w+"px; color:"+this.fontColor),this.c[3]=this.getKnob(),this.setSvg(this.c[3],"stroke",this.fontColor,1),this.setSvg(this.c[3],"stroke",this.fontColor,3),this.setSvg(this.c[3],"d",this.makeGrad(),3),this.setSvg(this.c[3],"viewBox","0 0 "+this.ww+" "+this.ww),this.setCss(this.c[3],{width:this.w,height:this.w,left:0,top:this.top}),this.r=0,this.init(),this.update()}mode(t){if(this.cmode===t)return!1;switch(t){case 0:this.s[2].color=this.fontColor,this.setSvg(this.c[3],"fill",this.colors.button,0),this.setSvg(this.c[3],"stroke",this.fontColor,1);break;case 1:this.s[2].color=this.colorPlus,this.setSvg(this.c[3],"fill",this.colors.select,0),this.setSvg(this.c[3],"stroke",this.colorPlus,1);break}return this.cmode=t,!0}testZone(t){let s=this.local;return s.x===-1&&s.y===-1?"":s.y<=this.c[1].offsetHeight?"title":s.y>this.h-this.c[2].offsetHeight?"text":"knob"}mouseup(t){return this.isDown=!1,this.sendEnd(),this.mode(0)}mousedown(t){return this.isDown=!0,this.old=this.value,this.oldr=null,this.mousemove(t),this.mode(1)}mousemove(t){if(!this.isDown)return;let s=this.offset;s.x=this.radius-(t.clientX-this.zone.x),s.y=this.radius-(t.clientY-this.zone.y-this.top),this.r=-Math.atan2(s.x,s.y),this.oldr!==null&&(this.r=Math.abs(this.r-this.oldr)>Math.PI?this.oldr:this.r),this.r=this.r>this.mPI?this.mPI:this.r,this.r=this.r<-this.mPI?-this.mPI:this.r;let i=1/this.cirRange,e=(this.r+this.mPI)*i,l=this.range*e+this.min-this.old;(l>=this.step||l<=this.step)&&(l=Math.floor(l/this.step),this.value=this.numValue(this.old+l*this.step),this.update(!0),this.old=this.value,this.oldr=this.r)}wheel(t){if(this.testZone(t)==="knob"){let i=this.value-this.step*t.delta;return i>this.max?i=this.isCyclic?this.min:this.max:i<this.min&&(i=this.isCyclic?this.max:this.min),this.setValue(i),this.old=i,this.update(!0),!0}return!1}makeGrad(){let t="",s,i,e,l,o,u,c,f=64,x=Math.PI+this.mPI,g=Math.PI-this.mPI;this.step>5?(i=this.range/this.step,s=(x-g)/i):(s=(x-g)/f*2,i=f*.5);for(let d=0;d<=i;++d)e=x-s*d,l=f+Math.sin(e)*(f-20),o=f+Math.cos(e)*(f-20),u=f+Math.sin(e)*(f-24),c=f+Math.cos(e)*(f-24),t+="M"+l+" "+o+" L"+u+" "+c+" ";return t}update(t){this.c[2].textContent=this.value,this.percent=(this.value-this.min)/this.range;let s=this.percent*this.cirRange-this.mPI,i=Math.sin(s),e=Math.cos(s),l=25*i+64,o=-(25*e)+64,u=20*i+64,c=-(20*e)+64;this.setSvg(this.c[3],"d","M "+l+" "+o+" L "+u+" "+c,1),t&&this.send()}},T=class extends m{constructor(t={}){super(t);this.path=t.path||"",this.format=t.format||"",this.imageSize=t.imageSize||[20,20],this.isWithImage=this.path!=="",this.preLoadComplete=!1,this.tmpImage={},this.tmpUrl=[];let s=t.align||"center";this.sMode=0,this.tMode=0,this.listOnly=t.listOnly||!1,this.txt===""&&(this.p=0),this.buttonColor=t.bColor||this.colors.button;let i=Math.floor(this.h*.5)-5;this.c[2]=this.dom("div",this.css.basic+"top:0; display:none;"),this.c[3]=this.dom("div",this.css.txt+"text-align:"+s+"; line-height:"+(this.h-4)+"px; top:1px; background:"+this.buttonColor+"; height:"+(this.h-2)+"px; border-radius:"+this.radius+"px;"),this.c[4]=this.dom("path",this.css.basic+"position:absolute; width:10px; height:10px; top:"+i+"px;",{d:this.svgs.arrow,fill:this.fontColor,stroke:"none"}),this.scroller=this.dom("div",this.css.basic+"right:5px;  width:10px; background:#666; display:none;"),this.c[3].style.color=this.fontColor,this.list=t.list||[],this.items=[],this.prevName="",this.baseH=this.h,this.itemHeight=t.itemHeight||this.h-3,this.full=t.full||!1,this.py=0,this.ww=this.sb,this.scroll=!1,this.isDown=!1,this.current=null,this.side=t.side||"down",this.up=this.side==="down"?0:1,this.up?(this.c[2].style.top="auto",this.c[3].style.top="auto",this.c[4].style.top="auto",this.c[2].style.bottom=this.h-2+"px",this.c[3].style.bottom="1px",this.c[4].style.bottom=i+"px"):this.c[2].style.top=this.baseH+"px",this.listIn=this.dom("div",this.css.basic+"left:0; top:0; width:100%; background:rgba(0,0,0,0.2);"),this.listIn.name="list",this.topList=0,this.c[2].appendChild(this.listIn),this.c[2].appendChild(this.scroller),t.value!==void 0?isNaN(t.value)?this.value=t.value:this.value=this.list[t.value]:this.value=this.list[0],this.isOpenOnStart=t.open||!1,this.listOnly&&(this.baseH=5,this.c[3].style.display="none",this.c[4].style.display="none",this.c[2].style.top=this.baseH+"px",this.isOpenOnStart=!0),this.isWithImage&&this.preloadImage(),this.setList(this.list),this.init(),this.isOpenOnStart&&this.open(!0)}preloadImage(){this.preLoadComplete=!1,this.tmpImage={};for(let t=0;t<this.list.length;t++)this.tmpUrl.push(this.list[t]);this.loadOne()}nextImg(){this.tmpUrl.shift(),this.tmpUrl.length===0?(this.preLoadComplete=!0,this.addImages()):this.loadOne()}loadOne(){let t=this,s=this.tmpUrl[0],i=document.createElement("img");i.style.cssText="position:absolute; width:"+t.imageSize[0]+"px; height:"+t.imageSize[1]+"px",i.setAttribute("src",this.path+s+this.format),i.addEventListener("load",function(){t.imageSize[2]=i.width,t.imageSize[3]=i.height,t.tmpImage[s]=i,t.nextImg()})}testZone(t){let s=this.local;if(s.x===-1&&s.y===-1)return"";if(this.up&&this.isOpen){if(s.y>this.h-this.baseH)return"title";if(this.scroll&&s.x>this.sa+this.sb-20)return"scroll";if(s.x>this.sa)return this.testItems(s.y-this.baseH)}else{if(s.y<this.baseH+2)return"title";if(this.isOpen){if(this.scroll&&s.x>this.sa+this.sb-20)return"scroll";if(s.x>this.sa)return this.testItems(s.y-this.baseH)}}return""}testItems(t){let s="",i=this.items.length,e,l,o;for(;i--;)if(e=this.items[i],l=e.posy+this.topList,o=e.posy+this.itemHeight+1+this.topList,t>=l&&t<=o)return s="item"+i,this.unSelected(),this.current=e,this.selected(),s;return s}unSelected(){this.current&&(this.current.style.background="rgba(0,0,0,0.2)",this.current.style.color=this.fontColor,this.current=null)}selected(){this.current.style.background=this.colors.select,this.current.style.color="#FFF"}mouseup(t){this.isDown=!1}mousedown(t){let s=this.testZone(t);return s?(s==="scroll"?(this.isDown=!0,this.mousemove(t)):s==="title"?(this.modeTitle(2),this.listOnly||(this.isOpen?this.close():this.open())):this.current&&(this.value=this.list[this.current.id],this.send(),this.listOnly||(this.close(),this.setTopItem())),!0):!1}mousemove(t){let s=!1,i=this.testZone(t);if(!i)return s;if(i==="title")this.unSelected(),this.modeTitle(1),this.cursor("pointer");else if(i==="scroll"){if(this.cursor("s-resize"),this.modeScroll(1),this.isDown){this.modeScroll(2);let e=this.zone.y+this.baseH-2;this.update(t.clientY-e-this.sh*.5)}}else this.modeTitle(0),this.modeScroll(0),this.cursor("pointer");return i!==this.prevName&&(s=!0),this.prevName=i,s}wheel(t){return this.testZone(t)==="title"?!1:(this.py+=t.delta*10,this.update(this.py),!0)}reset(){this.prevName="",this.unSelected(),this.modeTitle(0),this.modeScroll(0)}modeScroll(t){if(t!==this.sMode){switch(t){case 0:this.scroller.style.background=this.buttonColor;break;case 1:this.scroller.style.background=this.colors.select;break;case 2:this.scroller.style.background=this.colors.down;break}this.sMode=t}}modeTitle(t){if(t===this.tMode)return;let s=this.s;switch(t){case 0:s[3].color=this.fontColor,s[3].background=this.buttonColor;break;case 1:s[3].color="#FFF",s[3].background=this.colors.select;break;case 2:s[3].color=this.fontColor,s[3].background=this.colors.down;break}this.tMode=t}clearList(){for(;this.listIn.children.length;)this.listIn.removeChild(this.listIn.lastChild);this.items=[]}setList(t){this.clearList(),this.list=t,this.length=this.list.length,this.maxItem=this.full?this.length:5,this.maxItem=this.length<this.maxItem?this.length:this.maxItem,this.maxHeight=this.maxItem*(this.itemHeight+1)+2,this.max=this.length*(this.itemHeight+1)+2,this.ratio=this.maxHeight/this.max,this.sh=this.maxHeight*this.ratio,this.range=this.maxHeight-this.sh,this.c[2].style.height=this.maxHeight+"px",this.scroller.style.height=this.sh+"px",this.max>this.maxHeight&&(this.ww=this.sb-20,this.scroll=!0);let s,i;for(let e=0;e<this.length;e++)i=this.list[e],s=this.dom("div",this.css.item+"width:"+this.ww+"px; height:"+this.itemHeight+"px; line-height:"+(this.itemHeight-5)+"px; color:"+this.fontColor+";"),s.name="item"+e,s.id=e,s.posy=(this.itemHeight+1)*e,this.listIn.appendChild(s),this.items.push(s),this.isWithImage||(s.textContent=i);this.setTopItem()}addImages(){let t=this.list.length;for(let s=0;s<t;s++)this.items[s].appendChild(this.tmpImage[this.list[s]]);this.setTopItem()}setTopItem(){if(this.isWithImage){if(!this.preLoadComplete)return;this.c[3].children.length||(this.canvas=document.createElement("canvas"),this.canvas.width=this.imageSize[0],this.canvas.height=this.imageSize[1],this.canvas.style.cssText="position:absolute; top:0px; left:0px;",this.ctx=this.canvas.getContext("2d"),this.c[3].appendChild(this.canvas)),this.tmpImage[this.value],this.ctx.drawImage(this.tmpImage[this.value],0,0,this.imageSize[2],this.imageSize[3],0,0,this.imageSize[0],this.imageSize[1])}else this.c[3].textContent=this.value}update(t){!this.scroll||(t=t<0?0:t,t=t>this.range?this.range:t,this.topList=-Math.floor(t/this.ratio),this.listIn.style.top=this.topList+"px",this.scroller.style.top=Math.floor(t)+"px",this.py=t)}parentHeight(t){this.group!==null?this.group.calc(t):this.isUI&&this.main.calc(t)}open(t){super.open(),this.update(0),this.h=this.maxHeight+this.baseH+5,this.scroll?this.scroller.style.display="block":(this.topList=0,this.h=this.baseH+5+this.max,this.scroller.style.display="none"),this.s[0].height=this.h+"px",this.s[2].display="block",this.up?(this.zone.y-=this.h-(this.baseH-10),this.setSvg(this.c[4],"d",this.svgs.arrowUp)):this.setSvg(this.c[4],"d",this.svgs.arrowDown),this.rSizeContent();let s=this.h-this.baseH;this.zone.h=this.h,t||this.parentHeight(s)}close(){super.close(),this.up&&(this.zone.y+=this.h-(this.baseH-10));let t=this.h-this.baseH;this.h=this.baseH,this.s[0].height=this.h+"px",this.s[2].display="none",this.setSvg(this.c[4],"d",this.svgs.arrow),this.zone.h=this.h,this.parentHeight(-t)}text(t){this.c[3].textContent=t}rSizeContent(){let t=this.length;for(;t--;)this.listIn.children[t].style.width=this.ww+"px"}rSize(){m.prototype.rSize.call(this);let t=this.s,s=this.sb,i=this.sa;t[2]!==void 0&&(t[2].width=s+"px",t[2].left=i+"px",t[3].width=s+"px",t[3].left=i+"px",t[4].left=i+s-17+"px",this.ww=s,this.max>this.maxHeight&&(this.ww=s-20),this.isOpen&&this.rSizeContent())}},G=class extends m{constructor(t={}){super(t);this.setTypeNumber(t),this.allway=t.allway||!1,this.isDown=!1,this.value=[0],this.multy=1,this.invmulty=1,this.isSingle=!0,this.isAngle=!1,this.isVector=!1,t.isAngle&&(this.isAngle=!0,this.multy=a.torad,this.invmulty=a.todeg),this.isDrag=t.drag||!1,t.value!==void 0&&(isNaN(t.value)?t.value instanceof Array?(this.value=t.value,this.isSingle=!1):t.value instanceof Object&&(this.value=[],t.value.x!==void 0&&(this.value[0]=t.value.x),t.value.y!==void 0&&(this.value[1]=t.value.y),t.value.z!==void 0&&(this.value[2]=t.value.z),t.value.w!==void 0&&(this.value[3]=t.value.w),this.isVector=!0,this.isSingle=!1):this.value=[t.value]),this.lng=this.value.length,this.tmp=[],this.current=-1,this.prev={x:0,y:0,d:0,v:0},this.c[2]=this.dom("div",this.css.basic+" background:"+this.colors.select+"; top:4px; width:0px; height:"+(this.h-8)+"px;"),this.cMode=[];let s=this.lng;for(;s--;)this.isAngle&&(this.value[s]=(this.value[s]*180/Math.PI).toFixed(this.precision)),this.c[3+s]=this.dom("div",this.css.txtselect+" height:"+(this.h-4)+"px; background:"+this.colors.inputBg+"; borderColor:"+this.colors.inputBorder+"; border-radius:"+this.radius+"px;"),t.center&&(this.c[2+s].style.textAlign="center"),this.c[3+s].textContent=this.value[s],this.c[3+s].style.color=this.fontColor,this.c[3+s].isNum=!0,this.cMode[s]=0;this.cursorId=3+this.lng,this.c[this.cursorId]=this.dom("div",this.css.basic+"top:4px; height:"+(this.h-8)+"px; width:0px; background:"+this.fontColor+";"),this.init()}testZone(t){let s=this.local;if(s.x===-1&&s.y===-1)return"";let i=this.lng,e=this.tmp;for(;i--;)if(s.x>e[i][0]&&s.x<e[i][2])return i;return""}mousedown(t){let s=this.testZone(t);return this.isDown?!1:(this.isDown=!0,s!==""&&(this.current=s,this.prev={x:t.clientX,y:t.clientY,d:0,v:this.isSingle?parseFloat(this.value):parseFloat(this.value[this.current])},this.setInput(this.c[3+this.current])),this.mousemove(t))}mouseup(t){return this.isDown?(this.isDown=!1,this.prev={x:0,y:0,d:0,v:0},this.mousemove(t)):!1}mousemove(t){let s=!1,i=0;if(this.testZone(t)===""?this.cursor():this.isDrag?this.cursor(this.current!==-1?"move":"pointer"):this.cursor("text"),this.isDrag){if(this.current!==-1){this.prev.d+=t.clientX-this.prev.x-(t.clientY-this.prev.y);let l=this.prev.v+this.prev.d*this.step;this.value[this.current]=this.numValue(l),this.c[3+this.current].textContent=this.value[this.current],this.validate(),this.prev.x=t.clientX,this.prev.y=t.clientY,s=!0}}else return this.isDown&&(i=t.clientX-this.zone.x-3),this.current!==-1&&(i-=this.tmp[this.current][0]),this.upInput(i,this.isDown);return s}reset(){return!1}setValue(t){this.isVector?(t.x!==void 0&&(this.value[0]=t.x),t.y!==void 0&&(this.value[1]=t.y),t.z!==void 0&&(this.value[2]=t.z),t.w!==void 0&&(this.value[3]=t.w)):this.value=t,this.update()}sameStr(t){let s=this.value.length;for(;s--;)this.c[3+s].textContent=t}update(t){let s=this.value.length;for(;s--;)this.value[s]=this.numValue(this.value[s]*this.invmulty),this.c[3+s].textContent=this.value[s];t&&this.send()}send(t){t=t||this.value,this.isSend=!0,this.objectLink!==null&&(this.isVector?this.objectLink[this.val].fromArray(t):this.objectLink[this.val]=t),this.callback&&this.callback(t,this.val),this.isSend=!1}select(t,s,i){let e=this.s,l=this.current!==-1?this.tmp[this.current][0]+5:0;e[this.cursorId].width="1px",e[this.cursorId].left=l+t+"px",e[2].left=l+s+"px",e[2].width=i+"px"}unselect(){let t=this.s;!t||(t[2].width=0+"px",t[this.cursorId].width=0+"px")}validate(t){let s=[],i=this.lng;for(this.allway&&(t=!0);i--;){if(isNaN(this.c[3+i].textContent))this.c[3+i].textContent=this.value[i];else{let e=this.numValue(this.c[3+i].textContent);this.c[3+i].textContent=e,this.value[i]=e}s[i]=this.value[i]*this.multy}!t||(this.isSingle?this.send(s[0]):this.send(s))}rSize(){super.rSize();let t=Math.floor((this.sb+5)/this.lng)-5,s=this.s,i=this.lng;for(;i--;)this.tmp[i]=[Math.floor(this.sa+t*i+5*i),t],this.tmp[i][2]=this.tmp[i][0]+this.tmp[i][1],s[3+i].left=this.tmp[i][0]+"px",s[3+i].width=this.tmp[i][1]+"px"}},U=class extends m{constructor(t={}){super(t);if(this.setTypeNumber(t),this.model=t.stype||0,t.mode!==void 0&&(this.model=t.mode),this.buttonColor=t.bColor||this.colors.button,this.defaultBorderColor=this.colors.hide,this.isDown=!1,this.isOver=!1,this.allway=t.allway||!1,this.isDeg=t.isDeg||!1,this.isCyclic=t.cyclic||!1,this.firstImput=!1,this.c[2]=this.dom("div",this.css.txtselect+"border:none; width:47px; color:"+this.fontColor),this.c[3]=this.dom("div",this.css.basic+" top:0; height:"+this.h+"px;"),this.c[4]=this.dom("div",this.css.basic+"background:"+this.colors.scrollback+"; top:2px; height:"+(this.h-4)+"px;"),this.c[5]=this.dom("div",this.css.basic+"left:4px; top:5px; height:"+(this.h-10)+"px; background:"+this.fontColor+";"),this.c[2].isNum=!0,this.c[2].style.height=this.h-2+"px",this.c[2].style.lineHeight=this.h-10+"px",this.model!==0){let s=4,i=8,e=this.h-4,l=20;this.model===2&&(s=4,i=8,l=2,e=(this.h-4)*.5),this.model===3&&(this.c[5].style.visible="none"),this.c[4].style.borderRadius=s+"px",this.c[4].style.height=i+"px",this.c[4].style.top=this.h*.5-s+"px",this.c[5].style.borderRadius=s*.5+"px",this.c[5].style.height=s+"px",this.c[5].style.top=this.h*.5-s*.5+"px",this.c[6]=this.dom("div",this.css.basic+"border-radius:"+l+"px; margin-left:"+-e*.5+"px; border:1px solid "+this.colors.border+"; background:"+this.buttonColor+"; left:4px; top:2px; height:"+(this.h-4)+"px; width:"+e+"px;")}this.init()}testZone(t){let s=this.local;return s.x===-1&&s.y===-1?"":s.x>=this.txl?"text":s.x>=this.sa?"scroll":""}mouseup(t){this.isDown&&(this.isDown=!1)}mousedown(t){let s=this.testZone(t);return s?(s==="scroll"&&(this.isDown=!0,this.old=this.value,this.mousemove(t)),!0):!1}mousemove(t){let s=!1;if(this.testZone(t)==="scroll"?(this.mode(1),this.cursor("w-resize")):this.cursor(),this.isDown){let e=(t.clientX-(this.zone.x+this.sa)-3)/this.ww*this.range+this.min-this.old;(e>=this.step||e<=this.step)&&(e=Math.floor(e/this.step),this.value=this.numValue(this.old+e*this.step),this.update(!0),this.old=this.value),s=!0}return s}wheel(t){if(this.testZone(t)==="scroll"){let i=this.value-this.step*t.delta;return i>this.max?i=this.isCyclic?this.min:this.max:i<this.min&&(i=this.isCyclic?this.max:this.min),this.setValue(i),this.old=i,this.update(!0),!0}return!1}validate(){let t=this.c[2].textContent;isNaN(t)?this.c[2].textContent=this.value+(this.isDeg?"\xB0":""):(this.value=this.numValue(t),this.update(!0))}reset(){this.isDown=!1,this.mode(0)}mode(t){let s=this.s;switch(t){case 0:s[2].color=this.fontColor,s[4].background=this.colors.scrollback,s[5].background=this.fontColor;break;case 1:s[2].color=this.colorPlus,s[4].background=this.colors.scrollbackover,s[5].background=this.colorPlus;break}}update(t){let s=Math.floor(this.ww*((this.value-this.min)/this.range));this.model!==3&&(this.s[5].width=s+"px"),this.s[6]&&(this.s[6].left=this.sa+s+3+"px"),this.c[2].textContent=this.value+(this.isDeg?"\xB0":""),t&&this.send()}rSize(){super.rSize();let t=this.sb-this.sc;this.ww=t-6;let s=this.sc;(this.isUI||!this.simple)&&(s=this.sc+10),this.txl=this.w-s+2;let i=this.s;i[2].width=this.sc-6+"px",i[2].left=this.txl+4+"px",i[3].left=this.sa+"px",i[3].width=t+"px",i[4].left=this.sa+"px",i[4].width=t+"px",i[5].left=this.sa+3+"px",this.update()}},j=class extends m{constructor(t={}){super(t);this.cmode=0,this.value=t.value||"",this.placeHolder=t.placeHolder||"",this.allway=t.allway||!1,this.editable=t.edit!==void 0?t.edit:!0,this.isDown=!1,this.c[2]=this.dom("div",this.css.basic+" background:"+this.colors.select+"; top:4px; width:0px; height:"+(this.h-8)+"px;"),this.c[3]=this.dom("div",this.css.txtselect+"height:"+(this.h-4)+"px; background:"+this.colors.inputBg+"; borderColor:"+this.colors.inputBorder+"; border-radius:"+this.radius+"px;"),this.c[3].textContent=this.value,this.c[4]=this.dom("div",this.css.basic+"top:4px; height:"+(this.h-8)+"px; width:0px; background:"+this.fontColor+";"),this.c[5]=this.dom("div",this.css.txtselect+"height:"+(this.h-4)+"px; justify-content: center; font-style: italic; color:"+this.colors.inputHolder+";"),this.value===""&&(this.c[5].textContent=this.placeHolder),this.init()}testZone(t){let s=this.local;return s.x===-1&&s.y===-1?"":s.x>=this.sa?"text":""}mouseup(t){if(!!this.editable)return this.isDown?(this.isDown=!1,this.mousemove(t)):!1}mousedown(t){if(!this.editable)return;let s=this.testZone(t);return this.isDown?!1:(this.isDown=!0,s==="text"&&this.setInput(this.c[3]),this.mousemove(t))}mousemove(t){if(!this.editable)return;let s=this.testZone(t),i=0;return s==="text"?this.cursor("text"):this.cursor(),this.isDown&&(i=t.clientX-this.zone.x),this.upInput(i-this.sa-3,this.isDown)}update(){this.c[3].textContent=this.value}render(t,s,i){this.s[4].width="1px",this.s[4].left=this.sa+t+5+"px",this.s[2].left=this.sa+s+5+"px",this.s[2].width=i+"px"}reset(){this.cursor()}select(t,s,i){let e=this.s,l=this.sa+5;e[4].width="1px",e[4].left=l+t+"px",e[2].left=l+s+"px",e[2].width=i+"px"}unselect(){let t=this.s;!t||(t[2].width=0+"px",t[4].width=0+"px")}validate(t){this.allway&&(t=!0),this.value=this.c[3].textContent,this.value!==""?this.c[5].textContent="":this.c[5].textContent=this.placeHolder,!!t&&this.send()}rSize(){super.rSize();let t=this.s;t[3].left=this.sa+"px",t[3].width=this.sb+"px",t[5].left=this.sa+"px",t[5].width=this.sb+"px"}},X=class extends m{constructor(t={}){super(t);let s=t.prefix||"";this.c[2]=this.dom("div",this.css.txt+"text-align:right; width:60px; line-height:"+(this.h-8)+"px; color:"+this.fontColor),this.h===31&&(this.s[0].height=this.h+"px",this.s[1].top=8+"px",this.c[2].style.top=8+"px");let i=this.s;i[1].textAlign=t.align||"left",i[1].fontWeight=t.fontWeight||"bold",this.c[1].textContent=this.txt.substring(0,1).toUpperCase()+this.txt.substring(1).replace("-"," "),this.c[2].textContent=s,this.init()}text(t){this.c[1].textContent=t}text2(t){this.c[2].textContent=t}rSize(){super.rSize(),this.s[1].width=this.w+"px",this.s[2].left=this.w+"px"}},W=class extends m{constructor(t={}){super(t);this.value=t.value||"",this.isDown=!1,this.onActif=t.onActif||function(){},this.buttonColor=t.bColor||this.colors.button,this.buttonOver=t.bOver||this.colors.over,this.buttonDown=t.bDown||this.colors.select,this.buttonAction=t.bAction||this.colors.action,t.prefix,this.c[2]=this.dom("div",this.css.txt+this.css.button+" top:1px; background:"+this.buttonColor+"; height:"+(this.h-2)+"px; border:"+this.colors.buttonBorder+"; border-radius:15px; width:30px; left:10px;"),this.c[2].style.color=this.fontColor,this.c[3]=this.dom("div",this.css.txtselect+"height:"+(this.h-4)+"px; background:"+this.colors.inputBg+"; borderColor:"+this.colors.inputBorder+"; border-radius:"+this.radius+"px;"),this.c[3].textContent=this.value;let s=Math.floor(this.h*.5)-7;this.c[4]=this.dom("path",this.css.basic+"position:absolute; width:14px; height:14px; left:5px; top:"+s+"px;",{d:this.svgs.cursor,fill:this.fontColor,stroke:"none"}),this.stat=1,this.isActif=!1,this.init()}testZone(t){let s=this.local;return s.x===-1&&s.y===-1?"":s.x>this.sa&&s.x<this.sa+30?"over":"0"}mouseup(t){return this.isDown?(this.isDown=!1,this.mousemove(t)):!1}mousedown(t){return this.testZone(t)?(this.isDown=!0,this.mousemove(t)):!1}mousemove(t){let s=!1;return this.testZone(t)==="over"?(this.cursor("pointer"),s=this.mode(this.isDown?3:2)):s=this.reset(),s}apply(t){t=t||"",t!==this.value&&(this.value=t,this.c[3].textContent=this.value,this.send()),this.mode(1)}update(){this.mode(3)}mode(t){let s=!1;if(this.stat!==t){switch(t===1&&(this.isActif=!1),t===3&&(this.isActif?this.isActif=!1:(this.isActif=!0,t=4,this.onActif(this))),t===2&&this.isActif&&(t=4),t){case 1:this.stat=1,this.s[2].color=this.fontColor,this.s[2].background=this.buttonColor;break;case 2:this.stat=2,this.s[2].color=this.fontSelect,this.s[2].background=this.buttonOver;break;case 3:this.stat=3,this.s[2].color=this.fontSelect,this.s[2].background=this.buttonDown;break;case 4:this.stat=4,this.s[2].color=this.fontSelect,this.s[2].background=this.buttonAction;break}s=!0}return s}reset(){return this.cursor(),this.mode(this.isActif?4:1)}text(t){this.c[3].textContent=t}rSize(){super.rSize();let t=this.s;t[2].left=this.sa+"px",t[3].left=this.sa+40+"px",t[3].width=this.sb-40+"px",t[4].left=this.sa+8+"px"}},V=class extends m{constructor(t={}){super(t);this.values=t.values,typeof this.values=="string"&&(this.values=[this.values]),this.value=t.value||null,this.isSelectable=!0,t.selectable!==void 0&&(this.isSelectable=t.selectable),this.isDown=!1,this.buttonColor=t.bColor||this.colors.button,this.buttonOver=t.bOver||this.colors.over,this.buttonDown=t.bDown||this.colors.select,this.lng=this.values.length,this.tmp=[],this.stat=[];let s;for(let i=0;i<this.lng;i++)s=!1,this.values[i]===this.value&&this.isSelectable&&(s=!0),this.c[i+2]=this.dom("div",this.css.txt+this.css.button+" top:1px; height:"+(this.h-2)+"px; border:"+this.colors.buttonBorder+"; border-radius:"+this.radius+"px;"),this.c[i+2].style.background=s?this.buttonDown:this.buttonColor,this.c[i+2].style.color=s?this.fontSelect:this.fontColor,this.c[i+2].innerHTML=this.values[i],this.stat[i]=s?3:1;this.init()}testZone(t){let s=this.local;if(s.x===-1&&s.y===-1)return"";let i=this.lng,e=this.tmp;for(;i--;)if(s.x>e[i][0]&&s.x<e[i][2])return i;return-1}mouseup(t){return this.isDown?(this.isDown=!1,this.mousemove(t)):!1}mousedown(t){let s=this.testZone(t);return s<0?!1:(this.isDown=!0,this.value=this.values[s],this.send(),this.mousemove(t))}mousemove(t){let s=!1,i=this.testZone(t);return i!==-1?(this.cursor("pointer"),s=this.modes(this.isDown?3:2,i)):s=this.reset(),s}modes(t,s){let i,e=!1,l=this.lng;for(;l--;)l===s?i=this.mode(t,l):this.isSelectable?this.values[l]===this.value?i=this.mode(3,l):i=this.mode(1,l):i=this.mode(1,l),i&&(e=!0);return e}mode(t,s){let i=!1,e=s+2;if(this.stat[s]!==t){switch(t){case 1:this.stat[s]=1,this.s[e].color=this.fontColor,this.s[e].background=this.buttonColor;break;case 2:this.stat[s]=2,this.s[e].color=this.fontSelect,this.s[e].background=this.buttonOver;break;case 3:this.stat[s]=3,this.s[e].color=this.fontSelect,this.s[e].background=this.buttonDown;break}i=!0}return i}reset(){return this.cursor(),this.modes(1,-1)}label(t,s){s=s||2,this.c[s].textContent=t}icon(t,s,i){i=i||2,this.s[i].padding=(s||0)+"px 0px",this.c[i].innerHTML=t}rSize(){super.rSize();let t=this.s,s=this.sb,i=this.sa,e=this.lng,l=3,o=Math.floor((s-l*(e-1))/e);for(;e--;)this.tmp[e]=[Math.floor(i+o*e+l*e),o],this.tmp[e][2]=this.tmp[e][0]+this.tmp[e][1],t[e+2].left=this.tmp[e][0]+"px",t[e+2].width=this.tmp[e][1]+"px"}},Y=class extends m{constructor(t={}){t.simple=!0,t.isSpace=!0,super(t),this.init()}},_=class extends m{constructor(t={}){super(t);this.p=100,this.value=this.txt,this.status=1,this.itype=t.itype||"none",this.val=this.itype,this.graph=this.svgs[this.itype];let s=Math.floor(this.h*.5)-7;this.c[2]=this.dom("path",this.css.basic+"position:absolute; width:14px; height:14px; left:5px; top:"+s+"px;",{d:this.graph,fill:this.fontColor,stroke:"none"}),this.s[1].marginLeft=20+"px",this.init()}mousemove(t){this.cursor("pointer")}mousedown(t){return this.isUI&&this.main.resetItem(),this.selected(!0),this.send(),!0}uiout(){this.isSelect?this.mode(3):this.mode(1)}uiover(){this.isSelect?this.mode(4):this.mode(2)}update(){}mode(t){let s=!1;if(this.status!==t){switch(this.status=t,t){case 1:this.status=1,this.s[1].color=this.fontColor,this.s[0].background="none";break;case 2:this.status=2,this.s[1].color=this.fontColor,this.s[0].background=this.bgOver;break;case 3:this.status=3,this.s[1].color="#FFF",this.s[0].background=this.colors.select;break;case 4:this.status=4,this.s[1].color="#FFF",this.s[0].background=this.colors.down;break}s=!0}return s}reset(){this.cursor()}selected(t){this.isSelect&&this.mode(1),this.isSelect=t||!1,this.isSelect&&this.mode(3)}},Q=class extends m{constructor(t={}){super(t);this.values=t.values||[],typeof this.values=="string"&&(this.values=[this.values]),this.value=t.value||null,this.isSelectable=t.selectable||!1,this.isDown=!1,this.buttonColor=t.bColor||this.colors.button,this.buttonOver=t.bOver||this.colors.over,this.buttonDown=t.bDown||this.colors.select,this.spaces=t.spaces||[5,3],this.bsize=t.bsize||[90,20],this.bsizeMax=this.bsize[0],this.lng=this.values.length,this.tmp=[],this.stat=[],this.grid=[2,Math.round(this.lng*.5)],this.h=this.grid[1]*(this.bsize[1]+this.spaces[1])+this.spaces[1],this.c[1].textContent="",this.c[2]=this.dom("table",this.css.basic+"width:100%; top:"+(this.spaces[1]-2)+"px; height:auto; border-collapse:separate; border:none; border-spacing: "+(this.spaces[0]-2)+"px "+(this.spaces[1]-2)+"px;");let s=0,i,e,l,o;this.buttons=[],this.stat=[],this.tmpX=[],this.tmpY=[];for(let u=0;u<this.grid[1];u++){l=this.c[2].insertRow(),l.style.cssText="pointer-events:none;";for(let c=0;c<this.grid[0];c++)e=l.insertCell(),e.style.cssText="pointer-events:none;",this.values[s]?(o=!1,this.values[s]===this.value&&this.isSelectable&&(o=!0),i=document.createElement("div"),i.style.cssText=this.css.txt+this.css.button+"position:static; width:"+this.bsize[0]+"px; height:"+this.bsize[1]+"px; border:"+this.colors.buttonBorder+"; left:auto; right:auto; border-radius:"+this.radius+"px;",i.style.background=o?this.buttonDown:this.buttonColor,i.style.color=o?this.fontSelect:this.fontColor,i.innerHTML=this.values[s],e.appendChild(i),this.buttons.push(i),this.stat.push(1)):(i=document.createElement("div"),i.style.cssText=this.css.txt+"position:static; width:"+this.bsize[0]+"px; height:"+this.bsize[1]+"px; text-align:center;  left:auto; right:auto; background:none;",e.appendChild(i)),c===0?i.style.cssText+="float:right;":i.style.cssText+="float:left;",s++}this.init()}testZone(t){let s=this.local;if(s.x===-1&&s.y===-1)return-1;let i=this.tmpX,e=this.tmpY,l=-1,o=-1,u=-1,c=this.grid[0];for(;c--;)s.x>i[c][0]&&s.x<i[c][1]&&(o=c);for(c=this.grid[1];c--;)s.y>e[c][0]&&s.y<e[c][1]&&(u=c);return o!==-1&&u!==-1&&(l=o+u*2,l>this.lng-1&&(l=-1)),l}mouseup(t){return this.isDown?(this.isDown=!1,this.mousemove(t)):!1}mousedown(t){let s=this.testZone(t);return s<0?!1:(this.isDown=!0,this.value=this.values[s],this.send(),this.mousemove(t))}mousemove(t){let s=!1,i=this.testZone(t);return i!==-1?(this.cursor("pointer"),s=this.modes(this.isDown?3:2,i)):s=this.reset(),s}modes(t,s){let i,e=!1,l=this.lng;for(;l--;)l===s?i=this.mode(t,l):this.isSelectable?this.values[l]===this.value?i=this.mode(3,l):i=this.mode(1,l):i=this.mode(1,l),i&&(e=!0);return e}mode(t,s){let i=!1;if(this.stat[s]!==t){switch(t){case 1:this.stat[s]=1,this.buttons[s].style.color=this.fontColor,this.buttons[s].style.background=this.buttonColor;break;case 2:this.stat[s]=2,this.buttons[s].style.color=this.fontSelect,this.buttons[s].style.background=this.buttonOver;break;case 3:this.stat[s]=3,this.buttons[s].style.color=this.fontSelect,this.buttons[s].style.background=this.buttonDown;break}i=!0}return i}reset(){return this.cursor(),this.modes(1,-1)}label(t,s){this.buttons[s].textContent=t}icon(t,s,i){this.buttons[i].style.padding=(s||0)+"px 0px",this.buttons[i].innerHTML=t}testW(){let t=this.spaces[0]*3+this.bsizeMax*2,s=!1;if(t>this.w?(this.bsize[0]=(this.w-this.spaces[0]*3)*.5,s=!0):this.bsize[0]!==this.bsizeMax&&(this.bsize[0]=this.bsizeMax,s=!0),!s)return;let i=this.buttons.length;for(;i--;)this.buttons[i].style.width=this.bsize[0]+"px"}rSize(){super.rSize(),this.testW();let t;this.tmpX=[],this.tmpY=[];for(let s=0;s<this.grid[0];s++)s===0?(t=this.w*.5-this.spaces[0]*.5,this.tmpX.push([t-this.bsize[0],t])):(t=this.w*.5+this.spaces[0]*.5,this.tmpX.push([t,t+this.bsize[0]]));t=this.spaces[1];for(let s=0;s<this.grid[1];s++)this.tmpY.push([t,t+this.bsize[1]]),t+=this.bsize[1]+this.spaces[1]}},q=function(){let h=arguments,t,s,i=!1,e=null;typeof h[0]=="string"?(t=h[0],s=h[1]||{}):typeof h[0]=="object"&&(i=!0,h[2]===void 0&&[].push.call(h,{}),t=h[2].type?h[2].type:"slide",s=h[2],s.name=h[1],s.value=h[0][h[1]]);let l=t.toLowerCase();switch(l==="group"&&(s.add=q),l){case"bool":e=new P(s);break;case"button":e=new E(s);break;case"circular":e=new Z(s);break;case"color":e=new R(s);break;case"fps":e=new A(s);break;case"graph":e=new N(s);break;case"group":e=new H(s);break;case"joystick":e=new B(s);break;case"knob":e=new F(s);break;case"knob2":e=new K(s);break;case"list":e=new T(s);break;case"list":e=new T(s);break;case"numeric":case"number":e=new G(s);break;case"slide":e=new U(s);break;case"textInput":case"string":e=new j(s);break;case"title":e=new X(s);break;case"select":e=new W(s);break;case"selector":e=new V(s);break;case"empty":case"space":e=new Y(s);break;case"item":e=new _(s);break;case"grid":e=new Q(s);break}if(e!==null)return i&&e.setReferency(h[0],h[1]),e},z=class{constructor(t={}){this.canvas=null,this.isEmpty=!0,this.colors=a.cloneColor(),this.css=a.cloneCss(),t.config&&this.setConfig(t.config),this.bg=t.bg||this.colors.background,t.transparent!==void 0&&(this.colors.background="none",this.colors.backgroundOver="none"),this.isReset=!0,this.tmpAdd=null,this.tmpH=0,this.isCanvas=t.isCanvas||!1,this.isCanvasOnly=!1,this.cssGui=t.css!==void 0?t.css:"",this.callback=t.callback===void 0?null:t.callback,this.forceHeight=t.maxHeight||0,this.lockHeight=t.lockHeight||!1,this.isItemMode=t.itemMode!==void 0?t.itemMode:!1,this.cn="",this.size=a.size,t.p!==void 0&&(this.size.p=t.p),t.w!==void 0&&(this.size.w=t.w),t.h!==void 0&&(this.size.h=t.h),t.s!==void 0&&(this.size.s=t.s),this.size.h=this.size.h<11?11:this.size.h,this.local=new k().neg(),this.zone={x:0,y:0,w:this.size.w,h:0},this.mouse=new k().neg(),this.h=0,this.prevY=-1,this.sw=0,this.isWithClose=t.close!==void 0?t.close:!0,this.bh=this.isWithClose?this.size.h:0,this.autoResize=t.autoResize===void 0?!0:t.autoResize,this.isCenter=t.center||!1,this.isOpen=!0,this.isDown=!1,this.isScroll=!1,this.uis=[],this.current=-1,this.target=null,this.decal=0,this.ratio=1,this.oy=0,this.isNewTarget=!1,this.content=a.dom("div",this.css.basic+" width:0px; height:auto; top:0px; "+this.cssGui),this.innerContent=a.dom("div",this.css.basic+"width:100%; top:0; left:0; height:auto; overflow:hidden;"),this.content.appendChild(this.innerContent),this.inner=a.dom("div",this.css.basic+"width:100%; left:0; "),this.innerContent.appendChild(this.inner),this.scrollBG=a.dom("div",this.css.basic+"right:0; top:0; width:"+(this.size.s-1)+"px; height:10px; display:none; background:"+this.bg+";"),this.content.appendChild(this.scrollBG),this.scroll=a.dom("div",this.css.basic+"background:"+this.colors.scroll+"; right:2px; top:0; width:"+(this.size.s-4)+"px; height:10px;"),this.scrollBG.appendChild(this.scroll);let s=t.radius||this.colors.radius;this.bottom=a.dom("div",this.css.txt+"width:100%; top:auto; bottom:0; left:0; border-bottom-right-radius:"+s+"px;  border-bottom-left-radius:"+s+"px; text-align:center; height:"+this.bh+"px; line-height:"+(this.bh-5)+"px;"),this.content.appendChild(this.bottom),this.bottom.textContent="Close",this.bottom.style.background=this.bg,this.parent=t.parent!==void 0?t.parent:null,this.parent=t.target!==void 0?t.target:this.parent,this.parent===null&&!this.isCanvas&&(this.parent=document.body,this.isCenter||(this.content.style.right="10px")),this.parent!==null&&this.parent.appendChild(this.content),this.isCanvas&&this.parent===null&&(this.isCanvasOnly=!0),this.isCanvasOnly||(this.content.style.pointerEvents="auto"),this.setWidth(),this.isCanvas&&this.makeCanvas(),p.add(this)}setTop(t,s){this.content.style.top=t+"px",s!==void 0&&(this.forceHeight=s),this.setHeight(),p.needReZone=!0}dispose(){this.clear(),this.parent!==null&&this.parent.removeChild(this.content),p.remove(this)}onDraw(){}makeCanvas(){this.canvas=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.canvas.width=this.zone.w,this.canvas.height=this.forceHeight?this.forceHeight:this.zone.h}draw(t){if(this.canvas===null)return;let s=this.zone.w,i=this.forceHeight?this.forceHeight:this.zone.h;p.toCanvas(this,s,i,t)}getDom(){return this.content}setMouse(t){this.mouse.set(t.x,t.y)}setConfig(t){this.setColors(t),this.setText(t.fontSize,t.text,t.font,t.shadow)}setColors(t){for(let s in t)this.colors[s]&&(this.colors[s]=t[s])}setText(t,s,i,e){a.setText(t,s,i,e,this.colors,this.css)}hide(t){this.content.style.display=t?"none":"block"}onChange(t){return this.callback=t||null,this}mode(t){let s=!1;if(t!==this.cn){switch(this.cn=t,t){case"def":this.scroll.style.background=this.colors.scroll,this.bottom.style.background=this.colors.background,this.bottom.style.color=this.colors.text;break;case"scrollOver":this.scroll.style.background=this.colors.select;break;case"scrollDown":this.scroll.style.background=this.colors.down;break;case"bottomOver":this.bottom.style.background=this.colors.backgroundOver,this.bottom.style.color="#FFF";break}s=!0}return s}clearTarget(){return this.current===-1?!1:(this.target.uiout(),this.target.reset(),this.target=null,this.current=-1,p.cursor(),!0)}testZone(t){let s=this.local;if(s.x===-1&&s.y===-1)return"";this.isReset=!1;let i="",e=this.isScroll?this.zone.w-this.size.s:this.zone.w;return s.y>this.zone.h-this.bh&&s.y<this.zone.h?i="bottom":i=s.x>e?"scroll":"content",i}handleEvent(t){let s=t.type,i=!1,e=!1,l=this.testZone(t);if(s==="mouseup"&&this.isDown&&(this.isDown=!1),s==="mousedown"&&!this.isDown&&(this.isDown=!0),this.isDown&&this.isNewTarget&&(p.clearInput(),this.isNewTarget=!1),!!l){switch(l){case"content":t.clientY=this.isScroll?t.clientY+this.decal:t.clientY,p.isMobile&&s==="mousedown"&&this.getNext(t,i),this.target&&(e=this.target.handleEvent(t)),s==="mousemove"&&(i=this.mode("def")),s==="wheel"&&!e&&this.isScroll&&(i=this.onWheel(t)),p.lock||this.getNext(t,i);break;case"bottom":this.clearTarget(),s==="mousemove"&&(i=this.mode("bottomOver")),s==="mousedown"&&(this.isOpen=!this.isOpen,this.bottom.textContent=this.isOpen?"Close":"Open",this.setHeight(),this.mode("def"),i=!0);break;case"scroll":this.clearTarget(),s==="mousemove"&&(i=this.mode("scrollOver")),s==="mousedown"&&(i=this.mode("scrollDown")),s==="wheel"&&(i=this.onWheel(t)),this.isDown&&this.update(t.clientY-this.zone.y-this.sh*.5);break}this.isDown&&(i=!0),e&&(i=!0),s==="keyup"&&(i=!0),s==="keydown"&&(i=!0),i&&this.draw()}}getNext(t,s){let i=p.findTarget(this.uis,t);i!==this.current&&(this.clearTarget(),this.current=i,this.isNewTarget=!0),i!==-1&&(this.target=this.uis[this.current],this.target.uiover())}onWheel(t){return this.oy+=20*t.delta,this.update(this.oy),!0}reset(t){if(this.isReset)return;this.mouse.neg(),this.isDown=!1;let s=this.mode("def"),i=this.clearTarget();(s||i)&&this.draw(!0),this.isReset=!0}add(){let t=arguments,s=!1;typeof t[1]=="object"?(t[1].isUI=!0,t[1].main=this,s=t[1].ontop?t[1].ontop:!1):typeof t[1]=="string"&&(t[2]===void 0?[].push.call(t,{isUI:!0,main:this}):(t[2].isUI=!0,t[2].main=this,s=t[1].ontop?t[1].ontop:!1));let i=q.apply(this,t);if(i!==null){if(s?this.uis.unshift(i):this.uis.push(i),i.autoWidth)this.prevY=0,this.calc(i.h+1);else{let e=i.c[0].getBoundingClientRect().top;this.prevY!==e&&(this.calc(i.h+1),this.prevY=e)}return this.isEmpty=!1,i}}applyCalc(){this.calc(this.tmpH),this.tmpAdd=null}calcUis(){p.calcUis(this.uis,this.zone,this.zone.y)}remove(t){t.clear&&t.clear()}clearOne(t){let s=this.uis.indexOf(t);s!==-1&&(this.calc(-(this.uis[s].h+1)),this.inner.removeChild(this.uis[s].c[0]),this.uis.splice(s,1))}empty(){let t=this.uis.length,s;for(;t--;)s=this.uis.pop(),this.inner.removeChild(s.c[0]),s.clear(!0);this.isEmpty=!0,this.calc(-this.h)}clear(){this.empty()}resetItem(){if(!this.isItemMode)return;let t=this.uis.length;for(;t--;)this.uis[t].selected()}setItem(t){if(!this.isItemMode)return;if(t=t||"",this.resetItem(),!t){this.update(0);return}let s=this.uis.length;for(;s--;)this.uis[s].value===t&&(this.uis[s].selected(!0),this.isScroll&&this.update(s*(this.uis[s].h+1)*this.ratio))}upScroll(t){this.sw=t?this.size.s:0,this.oy=t?this.oy:0,this.scrollBG.style.display=t?"block":"none",t&&(this.total=this.h,this.maxView=this.maxHeight,this.ratio=this.maxView/this.total,this.sh=this.maxView*this.ratio,this.range=this.maxView-this.sh,this.oy=a.clamp(this.oy,0,this.range),this.scrollBG.style.height=this.maxView+"px",this.scroll.style.height=this.sh+"px"),this.setItemWidth(this.zone.w-this.sw),this.update(this.oy)}update(t){t=a.clamp(t,0,this.range),this.decal=Math.floor(t/this.ratio),this.inner.style.top=-this.decal+"px",this.scroll.style.top=Math.floor(t)+"px",this.oy=t}calc(t){this.h+=t,clearTimeout(this.tmp),this.tmp=setTimeout(this.setHeight.bind(this),10)}setHeight(){if(this.tmp&&clearTimeout(this.tmp),this.zone.h=this.bh,this.isScroll=!1,this.isOpen){let t=this.forceHeight?this.forceHeight+this.zone.y:window.innerHeight;this.maxHeight=t-this.zone.y-this.bh,this.h-this.maxHeight>1?(this.isScroll=!0,this.zone.h=this.maxHeight+this.bh):this.zone.h=this.h+this.bh}this.upScroll(this.isScroll),this.innerContent.style.height=this.zone.h-this.bh+"px",this.content.style.height=this.zone.h+"px",this.bottom.style.top=this.zone.h-this.bh+"px",this.forceHeight&&this.lockHeight&&(this.content.style.height=this.forceHeight+"px"),this.isOpen&&this.calcUis(),this.isCanvas&&this.draw(!0)}rezone(){p.needReZone=!0}setWidth(t){t&&(this.zone.w=t),this.content.style.width=this.zone.w+"px",this.isCenter&&(this.content.style.marginLeft=-Math.floor(this.zone.w*.5)+"px"),this.setItemWidth(this.zone.w-this.sw),this.setHeight(),this.isCanvasOnly||(p.needReZone=!0)}setItemWidth(t){let s=this.uis.length;for(;s--;)this.uis[s].setSize(t),this.uis[s].rSize()}},K=class extends m{constructor(t={}){super(t);this.isCyclic=t.cyclic||!1,this.autoWidth=!1,this.buttonColor=this.colors.button,this.setTypeNumber(t),this.mPI=Math.PI*.8,this.toDeg=180/Math.PI,this.cirRange=this.mPI*2,this.offset=new k,this.radius=this.w*.5,this.h=t.h||this.w+10,this.top=0,this.c[0].style.width=this.w+"px",this.c[1]!==void 0&&(this.c[1].style.width=this.w+"px",this.c[1].style.textAlign="center",this.top=10,this.h+=10),this.percent=0,this.cmode=0,this.c[2]=this.dom("div",this.css.txt+"text-align:center; top:"+(this.h-20)+"px; width:"+this.w+"px; color:"+this.fontColor),this.c[3]=this.getKnob(),r.dom("path","",{d:"",stroke:this.fontColor,"stroke-width":2,fill:"none","stroke-linecap":"round"},this.c[3]);let s=r.addAttributes(this.c[3],"g",{}),i=r.addAttributes(s,"defs",{}),e=r.addAttributes(i,"filter",{id:"glow"});r.addAttributes(e,"fegaussianblur",{class:"blur",result:"coloredBlur",stddeviation:"4"});let l=r.addAttributes(e,"femerge",{});for(let o=0;o<=3;o++)r.addAttributes(l,"femergenode",{in:"coloredBlur"});r.addAttributes(l,"femergenode",{in:"SourceGraphic"}),this.setSvg(this.c[3],"style","filter:url(#glow);",4),this.setSvg(this.c[3],"stroke",this.fontColor,1),this.setSvg(this.c[3],"stroke",this.fontColor,3),this.setSvg(this.c[3],"d",this.makeGrad(),3),this.setSvg(this.c[3],"viewBox","0 0 "+this.ww+" "+this.ww),this.setCss(this.c[3],{width:this.w,height:this.w,left:0,top:this.top}),this.r=0,this.init(),this.update()}mode(t){if(this.cmode===t)return!1;switch(t){case 0:this.s[2].color=this.fontColor,this.setSvg(this.c[3],"fill",this.colors.button,0),this.setSvg(this.c[3],"stroke",this.fontColor,1);break;case 1:this.s[2].color=this.colorPlus,this.setSvg(this.c[3],"fill",this.colors.select,0),this.setSvg(this.c[3],"stroke",this.colorPlus,1);break}return this.cmode=t,!0}testZone(t){let s=this.local;return s.x===-1&&s.y===-1?"":s.y<=this.c[1].offsetHeight?"title":s.y>this.h-this.c[2].offsetHeight?"text":"knob"}mouseup(t){return this.isDown=!1,this.sendEnd(),this.mode(0)}mousedown(t){return this.isDown=!0,this.old=this.value,this.oldr=null,this.mousemove(t),this.mode(1)}mousemove(t){if(!this.isDown)return;let s=this.offset;s.x=this.radius-(t.clientX-this.zone.x),s.y=this.radius-(t.clientY-this.zone.y-this.top),this.r=-Math.atan2(s.x,s.y),this.oldr!==null&&(this.r=Math.abs(this.r-this.oldr)>Math.PI?this.oldr:this.r),this.r=this.r>this.mPI?this.mPI:this.r,this.r=this.r<-this.mPI?-this.mPI:this.r;let i=1/this.cirRange,e=(this.r+this.mPI)*i,l=this.range*e+this.min-this.old;(l>=this.step||l<=this.step)&&(l=Math.floor(l/this.step),this.value=this.numValue(this.old+l*this.step),this.update(!0),this.old=this.value,this.oldr=this.r)}wheel(t){if(this.testZone(t)==="knob"){let i=this.value-this.step*t.delta;return i>this.max?i=this.isCyclic?this.min:this.max:i<this.min&&(i=this.isCyclic?this.max:this.min),this.setValue(i),this.old=i,this.update(!0),!0}return!1}lerpColor(t,s,i){let e={};for(var l=0;l<3;l++)e[l]=t[l]+(s[l]-t[l])*i;return e}makePath(){let t=Math.PI+this.mPI,s=this.percent*this.cirRange-this.mPI;var i=36;let e=i*Math.sin(t)+64,l=i*Math.cos(t)+64,o=i*Math.sin(s)+64,u=-i*Math.cos(s)+64,c=s<=Math.PI-this.mPI?0:1;return"M "+e+","+l+" A "+i+","+i+" 1 "+c+" 1 "+o+","+u}makeGrad(){let t="",s,i,e,l,o,u,c,f=64,x=Math.PI+this.mPI,g=Math.PI-this.mPI;this.step>5?(i=this.range/this.step,s=(x-g)/i):(s=(x-g)/f*2,i=f*.5);for(let d=0;d<=i;++d)e=x-s*d,l=f+Math.sin(e)*(f-20),o=f+Math.cos(e)*(f-20),u=f+Math.sin(e)*(f-24),c=f+Math.cos(e)*(f-24),t+="M"+l+" "+o+" L"+u+" "+c+" ";return t}update(t){this.c[2].textContent=this.value,this.percent=(this.value-this.min)/this.range;let s=this.percent*this.cirRange-this.mPI,i=Math.sin(s),e=Math.cos(s),l=25*i+64,o=-(25*e)+64,u=20*i+64,c=-(20*e)+64;this.setSvg(this.c[3],"d","M "+l+" "+o+" L "+u+" "+c,1),this.setSvg(this.c[3],"d",this.makePath(),4);let f=this.pack(this.lerpColor(r.unpack(r.ColorLuma(this.fontColor,-.75)),r.unpack(this.fontColor),this.percent));this.setSvg(this.c[3],"stroke",f,4),t&&this.send()}p255(t){let s=Math.round(t*255).toString(16);return s.length<2&&(s="0"+s),s}pack(t){return"#"+this.p255(t[0])+this.p255(t[1])+this.p255(t[2])}};z.prototype.isGui=!0;var st=function(h){debug.innerHTML=h},L=new z({css:"top:10px; left:50%;",w:256,h:26,close:!0,center:!0}).onChange(st);L.add("title",{name:"Luminar knobs",h:40,align:"center"});var D=L.add("group",{name:"Small Knobs",fontColor:"#D4B87B",h:30}),O=L.add("group",{name:"Knobs",fontColor:"#D4B87B",h:30}),J=L.add("group",{name:"Big Knobs",fontColor:"#D4B87B",h:30});D.add("knob2",{name:"knob",w:64,min:0,max:100,value:25,precision:0,step:5,fontColor:"#de9918"});D.add("knob2",{name:"knob",w:64,min:0,max:100,value:50,precision:0,step:5,fontColor:"#db0000"});D.add("knob2",{name:"knob",w:64,min:0,max:100,value:70,precision:0,step:5,fontColor:"#1f97ed"});D.add("knob2",{name:"knob",w:64,min:0,max:100,value:70,precision:0,step:5,fontColor:"#0ca811"});O.add("knob2",{name:"knob",w:85,min:0,max:100,value:25,precision:0,step:5,fontColor:"#de9918"});O.add("knob2",{name:"knob",w:85,min:0,max:100,value:50,precision:0,step:5,fontColor:"#db0000"});O.add("knob2",{name:"knob",w:85,min:0,max:100,value:70,precision:0,step:5,fontColor:"#1f97ed"});J.add("knob2",{name:"knob",w:128,min:0,max:100,value:25,precision:0,step:5,fontColor:"#de9918"});J.add("knob2",{name:"knob",w:128,min:0,max:100,value:25,precision:0,step:5,fontColor:"#a8088e"});})();
